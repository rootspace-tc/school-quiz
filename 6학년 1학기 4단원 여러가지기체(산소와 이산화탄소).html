<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í™”í•™ ë°˜ì‘ í†µí•© ì‹œë®¬ë ˆì´ì…˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Jua', sans-serif;
            touch-action: none; /* ëª¨ë°”ì¼ ë“œë˜ê·¸ ì‹œ í™”ë©´ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        }
        .supply-item, .welcome-button {
            cursor: pointer;
            user-select: none;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .supply-item:active {
            cursor: grabbing;
        }
        .supply-item:active, .welcome-button:active {
            transform: scale(1.05);
            z-index: 100;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        #flask {
            width: 400px;
            height: 500px;
            border-bottom: 8px solid #9ca3af;
            border-left: 8px solid #9ca3af;
            border-right: 8px solid #9ca3af;
            border-bottom-left-radius: 150px;
            border-bottom-right-radius: 150px;
            position: relative;
            background: linear-gradient(to top, rgba(191, 219, 254, 0.4), rgba(191, 219, 254, 0.1));
            margin: 0 auto;
        }
        #flask::before {
            content: '';
            position: absolute;
            top: -60px;
            left: calc(50% - 100px);
            width: 200px;
            height: 60px;
            border-top: 8px solid #9ca3af;
            border-left: 8px solid #9ca3af;
            border-right: 8px solid #9ca3af;
        }
        #beaker {
            border-bottom: 5px solid #60a5fa;
            border-left: 5px solid #60a5fa;
            border-right: 5px solid #60a5fa;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            position: relative;
            background: linear-gradient(to top, rgba(229, 231, 235, 0.4), rgba(229, 231, 235, 0.1));
        }
        .molecule { position: absolute; transition: all 0.5s ease-in-out; }
        .catalyst-active { animation: pulse 1s infinite; }
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 15px rgba(234, 179, 8, 0.7); }
            50% { box-shadow: 0 0 0px rgba(234, 179, 8, 0); }
        }
        .o2-bubble, .co2-bubble { position: absolute; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        
        /* ì‚°ì†Œ ê±°í’ˆ í¬ê¸° 3ë°° ì¦ê°€ (45px -> 135px) */
        .o2-bubble { 
            background-color: rgba(209, 213, 219, 0.8); 
            width: 135px; 
            height: 135px; 
            animation: rise-o2 3s ease-in forwards; 
            font-size: 42px; /* ê¸€ì”¨ í¬ê¸° ì¡°ì • */
            color: #374151;
        }
        
        /* ì´ì‚°í™”íƒ„ì†Œ ê±°í’ˆ í¬ê¸° 3ë°° ì¦ê°€ (40px -> 120px) */
        .co2-bubble { 
            background-color: rgba(209, 213, 219, 0.7); 
            width: 120px; 
            height: 120px; 
            animation: rise-co2 2.5s ease-in forwards; 
            font-size: 36px; /* ê¸€ì”¨ í¬ê¸° ì¡°ì • */
            color: #4b5563;
        }

        @keyframes rise-o2 { 0% { transform: translateY(0) scale(0.5); opacity: 1; } 100% { transform: translateY(-500px) scale(1.2); opacity: 0; } }
        @keyframes rise-co2 { 0% { transform: translateY(0) scale(0.5); opacity: 1; } 100% { transform: translateY(-450px) scale(1.2); opacity: 0; } }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4 text-lg">

    <div class="w-full max-w-7xl">
        <!-- ê³µí†µ í—¤ë” -->
        <header class="text-center mb-6 bg-white p-4 rounded-xl shadow-lg flex justify-between items-center">
            <h1 id="main-title" class="text-2xl md:text-4xl font-bold text-gray-800">ğŸ‘©â€ğŸ”¬ í™”í•™ ë°˜ì‘ í†µí•© ì‹œë®¬ë ˆì´ì…˜</h1>
            <div class="flex items-center space-x-2">
                 <button class="home-button hidden bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-full transition-colors">í™ˆìœ¼ë¡œ</button>
                 <span class="text-sm text-gray-600 hidden sm:inline">ê¸€ì”¨ í¬ê¸°:</span>
                 <button id="decrease-font" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-full transition-colors">-</button>
                 <button id="increase-font" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-full transition-colors">+</button>
            </div>
        </header>
        
        <!-- ì‹œì‘ í™”ë©´ -->
        <div id="welcome-screen" class="text-center p-8">
            <h2 class="text-3xl font-bold mb-6 resizable-text">ì–´ë–¤ ì‹¤í—˜ì„ í•´ë³¼ê¹Œìš”?</h2>
            <div class="flex flex-col md:flex-row justify-center items-center gap-8">
                <button id="start-oxygen-sim" class="welcome-button w-64 h-40 bg-blue-500 text-white rounded-2xl shadow-xl flex flex-col justify-center items-center">
                    <span class="text-2xl font-bold">ì‚°ì†Œ(Oâ‚‚) ë°œìƒ ì‹¤í—˜</span>
                    <span class="text-sm mt-2">(ê³¼ì‚°í™”ìˆ˜ì†Œ + ì´ì‚°í™”ë§ê°€ë‹ˆì¦ˆ)</span>
                </button>
                <button id="start-co2-sim" class="welcome-button w-64 h-40 bg-green-500 text-white rounded-2xl shadow-xl flex flex-col justify-center items-center">
                    <span class="text-2xl font-bold">ì´ì‚°í™”íƒ„ì†Œ(COâ‚‚) ë°œìƒ ì‹¤í—˜</span>
                    <span class="text-sm mt-2">(ì‹ì´ˆ + ë² ì´í‚¹ì†Œë‹¤)</span>
                </button>
            </div>
        </div>

        <!-- ì‚°ì†Œ(O2) ë°œìƒ ì‹œë®¬ë ˆì´ì…˜ -->
        <div id="oxygen-simulation" class="hidden">
            <p class="text-center text-lg text-gray-600 mt-2 mb-6 resizable-text">ê³¼ì‚°í™”ìˆ˜ì†Œ(Hâ‚‚Oâ‚‚) ë¶„í•´ ë°˜ì‘ì—ì„œ ì´ì‚°í™” ë§ê°€ë‹ˆì¦ˆ(MnOâ‚‚) ì´‰ë§¤ì˜ ì—­í• ì„ ì•Œì•„ë´…ì‹œë‹¤!</p>
            <main class="grid grid-cols-1 md:grid-cols-3 gap-6 bg-white p-6 rounded-2xl shadow-xl">
                <div class="flex flex-col items-center justify-around p-4 border-2 border-dashed rounded-lg bg-gray-50 min-h-[500px]">
                    <h2 class="text-2xl font-bold text-gray-700 resizable-text">ì¬ë£Œ ê³µê¸‰</h2>
                    <p class="text-center text-gray-500 resizable-text">ì•„ë˜ ì¬ë£Œë¥¼<br>ì˜¤ë¥¸ìª½ í”Œë¼ìŠ¤í¬ë¡œ ë“œë˜ê·¸ í•´ë³´ì„¸ìš”.</p>
                    <div class="space-y-6">
                        <div id="h2o2-supply" draggable="true" class="supply-item w-48 h-20 bg-blue-200 border-2 border-blue-400 rounded-lg flex flex-col items-center justify-center text-center font-bold resizable-text">ë¬½ì€ ê³¼ì‚°í™”ìˆ˜ì†Œìˆ˜<span>Hâ‚‚Oâ‚‚</span></div>
                        <div id="mno2-supply" draggable="true" class="supply-item w-48 h-20 bg-gray-600 text-white border-2 border-gray-800 rounded-full flex flex-col items-center justify-center text-center font-bold resizable-text">ì´ì‚°í™” ë§ê°€ë‹ˆì¦ˆ (ì´‰ë§¤)<span>MnOâ‚‚</span></div>
                    </div>
                </div>
                <div class="col-span-1 md:col-span-2 relative flex justify-center items-center">
                    <div id="flask"></div>
                </div>
            </main>
            <div class="w-full mt-6 p-4 rounded-lg shadow-md bg-gray-200 flex flex-col items-center justify-center text-center">
                <p id="o2-reaction-message" class="text-lg font-bold text-red-600 h-12 flex items-center resizable-text"></p>
                <button class="o2-reset-button mt-2 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-full transition-colors">ì‹¤í—˜ ë‹¤ì‹œí•˜ê¸°</button>
            </div>
            <footer class="w-full mt-6 grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                <div class="bg-blue-100 p-4 rounded-lg shadow-md"><h3 class="text-xl font-bold text-blue-800 resizable-text">í”Œë¼ìŠ¤í¬ ì•ˆì˜ Hâ‚‚Oâ‚‚</h3><p id="h2o2-count" class="text-4xl font-bold text-blue-600">0</p></div>
                <div class="bg-gray-300 p-4 rounded-lg shadow-md"><h3 class="text-xl font-bold text-gray-800 resizable-text">í”Œë¼ìŠ¤í¬ ì•ˆì˜ MnOâ‚‚</h3><p id="mno2-count" class="text-4xl font-bold text-gray-600">0</p></div>
                <div class="bg-green-100 p-4 rounded-lg shadow-md"><h3 class="text-xl font-bold text-green-800 resizable-text">ìƒì„±ëœ ì‚°ì†Œ(Oâ‚‚)</h3><p id="o2-count" class="text-4xl font-bold text-green-600">0</p></div>
            </footer>
        </div>

        <!-- ì´ì‚°í™”íƒ„ì†Œ(CO2) ë°œìƒ ì‹œë®¬ë ˆì´ì…˜ -->
        <div id="co2-simulation" class="hidden">
             <p class="text-center text-lg text-gray-600 mt-2 mb-6 resizable-text">ì‹ì´ˆ(CHâ‚ƒCOOH)ì™€ ë² ì´í‚¹ ì†Œë‹¤(NaHCOâ‚ƒ)ì˜ ë°˜ì‘ì—ì„œ 'í•œê³„ ë°˜ì‘ë¬¼'ì˜ ì—­í• ì„ ì•Œì•„ë´…ì‹œë‹¤!</p>
            <main class="grid grid-cols-1 md:grid-cols-3 gap-6 bg-white p-6 rounded-2xl shadow-xl">
                <div class="flex flex-col items-center justify-around p-4 border-2 border-dashed rounded-lg bg-gray-50 min-h-[500px]">
                    <h2 class="text-2xl font-bold text-gray-700 resizable-text">ë°˜ì‘ë¬¼ ê³µê¸‰</h2>
                    <p class="text-center text-gray-500 resizable-text">ì•„ë˜ ë¶„ìë“¤ì„<br>ì˜¤ë¥¸ìª½ ë¹„ì»¤ë¡œ ë“œë˜ê·¸ í•´ë³´ì„¸ìš”.</p>
                    <div class="space-y-6">
                        <div id="vinegar-supply" draggable="true" class="supply-item w-40 h-16 bg-blue-200 border-2 border-blue-400 rounded-lg flex items-center justify-center text-center font-bold resizable-text">ì‹ì´ˆ<br>CHâ‚ƒCOOH</div>
                        <div id="baking-soda-supply" draggable="true" class="supply-item w-40 h-16 bg-green-200 border-2 border-green-400 rounded-lg flex items-center justify-center text-center font-bold resizable-text">ë² ì´í‚¹ ì†Œë‹¤<br>NaHCOâ‚ƒ</div>
                    </div>
                </div>
                <div id="beaker" class="h-96 md:h-[500px] col-span-1 md:col-span-2 p-4 flex flex-wrap content-end gap-2"></div>
            </main>
            <div class="w-full mt-6 p-4 rounded-lg shadow-md bg-gray-200 flex flex-col items-center justify-center text-center">
                 <p id="co2-reaction-message" class="text-lg font-bold text-red-600 h-12 flex items-center resizable-text"></p>
                 <button class="co2-reset-button mt-2 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-full transition-colors">ì‹¤í—˜ ë‹¤ì‹œí•˜ê¸°</button>
            </div>
            <footer class="w-full mt-6 grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                <div class="bg-blue-100 p-4 rounded-lg shadow-md"><h3 class="text-xl font-bold text-blue-800 resizable-text">ë¹„ì»¤ ì•ˆì˜ ì‹ì´ˆ</h3><p id="vinegar-count" class="text-4xl font-bold text-blue-600">0</p></div>
                <div class="bg-green-100 p-4 rounded-lg shadow-md"><h3 class="text-xl font-bold text-green-800 resizable-text">ë¹„ì»¤ ì•ˆì˜ ë² ì´í‚¹ ì†Œë‹¤</h3><p id="baking-soda-count" class="text-4xl font-bold text-green-600">0</p></div>
                <div class="bg-yellow-100 p-4 rounded-lg shadow-md"><h3 class="text-xl font-bold text-yellow-800 resizable-text">ìƒì„±ëœ ì´ì‚°í™”íƒ„ì†Œ</h3><p id="co2-count" class="text-4xl font-bold text-yellow-600">0</p></div>
            </footer>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- ê³µí†µ ìš”ì†Œ ---
        const welcomeScreen = document.getElementById('welcome-screen');
        const oxygenSimScreen = document.getElementById('oxygen-simulation');
        const co2SimScreen = document.getElementById('co2-simulation');
        const startOxygenBtn = document.getElementById('start-oxygen-sim');
        const startCo2Btn = document.getElementById('start-co2-sim');
        const homeButtons = document.querySelectorAll('.home-button');
        const mainTitle = document.getElementById('main-title');
        
        const increaseFontBtn = document.getElementById('increase-font');
        const decreaseFontBtn = document.getElementById('decrease-font');
        let currentFontSize = 1.125; // rem ë‹¨ìœ„ (18px)
        
        // --- ì‚°ì†Œ(O2) ì‹œë®¬ë ˆì´ì…˜ ìš”ì†Œ ---
        const flask = document.getElementById('flask');
        const h2o2Supply = document.getElementById('h2o2-supply');
        const mno2Supply = document.getElementById('mno2-supply');
        const h2o2CountDisplay = document.getElementById('h2o2-count');
        const mno2CountDisplay = document.getElementById('mno2-count');
        const o2CountDisplay = document.getElementById('o2-count');
        const o2MessageDisplay = document.getElementById('o2-reaction-message');
        const o2ResetButton = document.querySelector('.o2-reset-button');
        let naturalDecompositionInterval;

        // --- ì´ì‚°í™”íƒ„ì†Œ(CO2) ì‹œë®¬ë ˆì´ì…˜ ìš”ì†Œ ---
        const beaker = document.getElementById('beaker');
        const vinegarSupply = document.getElementById('vinegar-supply');
        const bakingSodaSupply = document.getElementById('baking-soda-supply');
        const vinegarCountDisplay = document.getElementById('vinegar-count');
        const bakingSodaCountDisplay = document.getElementById('baking-soda-count');
        const co2CountDisplay = document.getElementById('co2-count');
        const co2MessageDisplay = document.getElementById('co2-reaction-message');
        const co2ResetButton = document.querySelector('.co2-reset-button');
        let vinegarInBeaker = 0;
        let bakingSodaInBeaker = 0;
        let co2Count = 0;

        // --- ê³µí†µ ê¸°ëŠ¥ ---
        function showScreen(screenToShow) {
            welcomeScreen.classList.add('hidden');
            oxygenSimScreen.classList.add('hidden');
            co2SimScreen.classList.add('hidden');
            homeButtons.forEach(b => b.classList.remove('hidden'));
            if(screenToShow) screenToShow.classList.remove('hidden');
            else welcomeScreen.classList.remove('hidden');
        }

        function updateFontSize() {
            const resizableElements = document.querySelectorAll('.resizable-text');
            resizableElements.forEach(el => {
                el.style.fontSize = `${currentFontSize}rem`;
            });
        }
        updateFontSize(); // ì´ˆê¸° í°íŠ¸ í¬ê¸° ì ìš©

        increaseFontBtn.addEventListener('click', () => {
            if (currentFontSize < 3) { // ìµœëŒ€ í¬ê¸° ì œí•œ
                currentFontSize += 0.1;
                updateFontSize();
            }
        });

        decreaseFontBtn.addEventListener('click', () => {
            if (currentFontSize > 0.7) { // ìµœì†Œ í¬ê¸° ì œí•œ
                currentFontSize -= 0.1;
                updateFontSize();
            }
        });

        startOxygenBtn.addEventListener('click', () => {
            showScreen(oxygenSimScreen);
            mainTitle.textContent = 'ğŸ”¬ ì‚°ì†Œ(Oâ‚‚) ë°œìƒ ì‹¤í—˜';
            initializeOxygenSim();
        });

        startCo2Btn.addEventListener('click', () => {
            showScreen(co2SimScreen);
            mainTitle.textContent = 'ğŸ§ª ì´ì‚°í™”íƒ„ì†Œ(COâ‚‚) ë°œìƒ ì‹¤í—˜';
            initializeCo2Sim();
        });

        homeButtons.forEach(button => button.addEventListener('click', () => {
            showScreen(null);
            mainTitle.textContent = 'ğŸ‘©â€ğŸ”¬ í™”í•™ ë°˜ì‘ í†µí•© ì‹œë®¬ë ˆì´ì…˜';
            homeButtons.forEach(b => b.classList.add('hidden'));
            if (naturalDecompositionInterval) clearInterval(naturalDecompositionInterval);
        }));


        // --- O2 ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ ---
        function initializeOxygenSim() {
            flask.innerHTML = '';
            o2MessageDisplay.textContent = 'ì¬ë£Œë¥¼ í”Œë¼ìŠ¤í¬ì— ë„£ì–´ì£¼ì„¸ìš”.';
            o2CountDisplay.textContent = '0';
            if (naturalDecompositionInterval) clearInterval(naturalDecompositionInterval);
            updateOxygenDisplays();

            naturalDecompositionInterval = setInterval(() => {
                const h2o2Molecule = flask.querySelector('.h2o2-molecule');
                if (h2o2Molecule) {
                    o2MessageDisplay.textContent = 'ê³¼ì‚°í™”ìˆ˜ì†ŒëŠ” ìŠ¤ìŠ¤ë¡œ ì•„ì£¼ ì²œì²œíˆ ë¶„í•´ë©ë‹ˆë‹¤...';
                    decomposeH2O2(h2o2Molecule);
                }
            }, 10000); // 10ì´ˆë¡œ ë³€ê²½ (0.5ë°° ì†ë„)
        }

        function updateOxygenDisplays() {
            h2o2CountDisplay.textContent = flask.querySelectorAll('.h2o2-molecule').length;
            mno2CountDisplay.textContent = flask.querySelectorAll('.catalyst-molecule').length;
        }

        function addMoleculeToFlask(type) {
            const molecule = document.createElement('div');
            molecule.className = 'molecule';
            const flaskRect = flask.getBoundingClientRect();
            const x = Math.random() * (flaskRect.width - 100);
            const y = Math.random() * (flaskRect.height / 2);
            molecule.style.left = `${x}px`;
            molecule.style.bottom = `${y}px`;

            if (type === 'h2o2') {
                molecule.innerHTML = `<div class="h2o2-molecule w-24 h-12 bg-blue-200 border-2 border-blue-400 rounded-lg flex items-center justify-center text-center text-xs font-bold resizable-text">Hâ‚‚Oâ‚‚</div>`;
            } else {
                molecule.innerHTML = `<div class="catalyst-molecule w-24 h-12 bg-gray-600 text-white border-2 border-gray-800 rounded-full flex items-center justify-center text-center text-xs font-bold resizable-text">MnOâ‚‚</div>`;
                setTimeout(() => activateCatalyst(molecule), 100);
            }
            flask.appendChild(molecule);
            updateOxygenDisplays();
            updateFontSize();
        }

        function activateCatalyst(catalystElement) {
            catalystElement.querySelector('.catalyst-molecule').classList.add('catalyst-active');
            const catalystInterval = setInterval(() => {
                if (!flask.contains(catalystElement)) {
                    clearInterval(catalystInterval);
                    return;
                }
                const h2o2Molecule = flask.querySelector('.h2o2-molecule');
                if (h2o2Molecule) {
                    o2MessageDisplay.textContent = 'ì´‰ë§¤ê°€ ë°˜ì‘ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ í•©ë‹ˆë‹¤!';
                    const h2o2Rect = h2o2Molecule.parentElement.getBoundingClientRect();
                    const flaskRect = flask.getBoundingClientRect();
                    catalystElement.style.left = `${h2o2Rect.left - flaskRect.left}px`;
                    catalystElement.style.bottom = `${flaskRect.bottom - h2o2Rect.bottom}px`;
                    setTimeout(() => {
                        if (flask.contains(h2o2Molecule.parentElement)) {
                           decomposeH2O2(h2o2Molecule, () => {
                                if(flask.contains(catalystElement)){
                                    const x = Math.random() * (flask.clientWidth - 100);
                                    const y = Math.random() * (flask.clientHeight / 2);
                                    catalystElement.style.left = `${x}px`;
                                    catalystElement.style.bottom = `${y}px`;
                                }
                           });
                        }
                    }, 600);
                } else {
                    o2MessageDisplay.textContent = 'ì´‰ë§¤ëŠ” ë°˜ì‘í•  ê³¼ì‚°í™”ìˆ˜ì†Œë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.';
                }
            }, 1500);
        }

        function decomposeH2O2(h2o2Molecule, callback) {
            const parent = h2o2Molecule.parentElement;
            if (!parent || !flask.contains(parent)) return;
            const rect = parent.getBoundingClientRect();
            const flaskRect = flask.getBoundingClientRect();
            parent.remove();
            for (let i = 0; i < 2; i++) {
                const waterMolecule = document.createElement('div');
                waterMolecule.className = 'molecule';
                waterMolecule.innerHTML = `<div class="w-20 h-10 bg-cyan-200 border-2 border-cyan-400 rounded-lg flex items-center justify-center text-center text-xs font-bold resizable-text">ë¬¼ (Hâ‚‚O)</div>`;
                waterMolecule.style.left = `${rect.left - flaskRect.left + (i * 40 - 20)}px`;
                waterMolecule.style.bottom = `${flaskRect.bottom - rect.bottom}px`;
                flask.appendChild(waterMolecule);
            }
            const bubble = document.createElement('div');
            bubble.className = 'o2-bubble';
            bubble.textContent = 'Oâ‚‚';
            bubble.style.left = `${rect.left - flaskRect.left - 50}px`;
            bubble.style.bottom = `${flaskRect.bottom - rect.bottom}px`;
            flask.appendChild(bubble);
            setTimeout(() => bubble.remove(), 3000);
            o2CountDisplay.textContent = parseInt(o2CountDisplay.textContent) + 1;
            updateOxygenDisplays();
            updateFontSize();
            if(callback) callback();
        }

        [h2o2Supply, mno2Supply].forEach(supply => {
            supply.addEventListener('dragstart', (e) => {
                const type = e.target.id === 'h2o2-supply' ? 'h2o2' : 'mno2';
                e.dataTransfer.setData('text/plain', type);
                e.target.style.opacity = '0.5';
            });
            supply.addEventListener('dragend', (e) => e.target.style.opacity = '1');
        });
        flask.addEventListener('dragover', (e) => e.preventDefault());
        flask.addEventListener('drop', (e) => {
            e.preventDefault();
            const type = e.dataTransfer.getData('text/plain');
            if (type === 'h2o2' || type === 'mno2') {
                addMoleculeToFlask(type);
            }
        });
        o2ResetButton.addEventListener('click', initializeOxygenSim);

        // --- CO2 ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ ---
        function initializeCo2Sim() {
            beaker.innerHTML = '';
            vinegarInBeaker = 0;
            bakingSodaInBeaker = 0;
            co2Count = 0;
            updateCo2Displays();
            co2MessageDisplay.textContent = 'ë°˜ì‘ë¬¼ì„ ë¹„ì»¤ì— ë„£ì–´ì£¼ì„¸ìš”.';
        }

        function updateCo2Displays() {
            vinegarCountDisplay.textContent = vinegarInBeaker;
            bakingSodaCountDisplay.textContent = bakingSodaInBeaker;
            co2CountDisplay.textContent = co2Count;
        }

        function addMoleculeToBeaker(type) {
            const molecule = document.createElement('div');
            let text, className;
            if (type === 'vinegar') {
                vinegarInBeaker++;
                text = 'ì‹ì´ˆ\nCHâ‚ƒCOOH';
                className = 'vinegar-molecule w-32 h-14 bg-blue-200 border-2 border-blue-400 rounded-lg flex items-center justify-center text-center font-bold resizable-text';
            } else {
                bakingSodaInBeaker++;
                text = 'ë² ì´í‚¹ ì†Œë‹¤\nNaHCOâ‚ƒ';
                className = 'baking-soda-molecule w-32 h-14 bg-green-200 border-2 border-green-400 rounded-lg flex items-center justify-center text-center font-bold resizable-text';
            }
            molecule.className = className;
            molecule.textContent = text;
            beaker.appendChild(molecule);
            updateCo2Displays();
            updateFontSize();
            checkForCo2Reaction();
        }

        function checkForCo2Reaction() {
            if (vinegarInBeaker > 0 && bakingSodaInBeaker > 0) {
                co2MessageDisplay.textContent = 'ë°˜ì‘ë¬¼ì´ ëª¨ë‘ ëª¨ì—¬ ë°˜ì‘ì´ ì¼ì–´ë‚©ë‹ˆë‹¤!';
                setTimeout(runCo2Reaction, 500);
            } else if(vinegarInBeaker > 0 || bakingSodaInBeaker > 0) {
                 co2MessageDisplay.textContent = 'ë‹¤ë¥¸ ë°˜ì‘ë¬¼ë„ ë„£ì–´ì£¼ì„¸ìš”!';
            }
        }

        function runCo2Reaction() {
            const vinegarMolecule = beaker.querySelector('.vinegar-molecule');
            const bakingSodaMolecule = beaker.querySelector('.baking-soda-molecule');
            
            if (vinegarMolecule && bakingSodaMolecule) {
                vinegarInBeaker--;
                bakingSodaInBeaker--;
                co2Count++;

                vinegarMolecule.remove();
                bakingSodaMolecule.remove();
                
                const product = document.createElement('div');
                product.className = 'w-48 h-14 bg-yellow-200 border-2 border-yellow-400 rounded-lg flex items-center justify-center text-center font-bold resizable-text';
                product.innerHTML = 'ì•„ì„¸íŠ¸ì‚°ë‚˜íŠ¸ë¥¨ + ë¬¼<br>+ â†‘ì´ì‚°í™”íƒ„ì†Œ(COâ‚‚)</span>';
                beaker.appendChild(product);
                
                const bubble = document.createElement('div');
                bubble.className = 'co2-bubble';
                bubble.textContent = 'COâ‚‚';
                bubble.style.left = `${Math.random() * (beaker.clientWidth - 120)}px`;
                beaker.appendChild(bubble);
                setTimeout(() => bubble.remove(), 2500);
            }
            updateCo2Displays();
            updateFontSize();
        }

        [vinegarSupply, bakingSodaSupply].forEach(supply => {
            supply.addEventListener('dragstart', (e) => {
                const type = e.target.id === 'vinegar-supply' ? 'vinegar' : 'baking-soda';
                e.dataTransfer.setData('text/plain', type);
                e.target.style.opacity = '0.5';
            });
            supply.addEventListener('dragend', (e) => e.target.style.opacity = '1');
        });
        beaker.addEventListener('dragover', (e) => e.preventDefault());
        beaker.addEventListener('drop', (e) => {
            e.preventDefault();
            const type = e.dataTransfer.getData('text/plain');
            if (type === 'vinegar' || type === 'baking-soda') {
                addMoleculeToBeaker(type);
            }
        });
        co2ResetButton.addEventListener('click', initializeCo2Sim);

    });
    </script>
</body>
</html>

