<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ì¹™ì—°ì‚° ë¹Œë“œ ê²Œì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    
    <style>
        /* Jua ê¸€ê¼´ ê¸°ë³¸ ì ìš© */
        body, html {
            font-family: 'Jua', sans-serif;
            height: 100%;
            margin: 0;
            padding: 0;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
            overflow: hidden;
        }
        
        /* ê¸°ë³¸ í™”ë©´ ìŠ¤íƒ€ì¼ */
        .screen {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  í™”ë©´ ìˆ¨ê¹€ */
            width: 100%;
            height: 100vh; /* ì „ì²´ í™”ë©´ ë†’ì´ */
            overflow-y: auto; /* ë‚´ìš© ë§ì„ ì‹œ ìŠ¤í¬ë¡¤ */
            box-sizing: border-box; /* íŒ¨ë”© í¬í•¨ í¬ê¸° ê³„ì‚° */
        }
        
        /* í˜„ì¬ í™œì„±í™”ëœ í™”ë©´ë§Œ ë³´ì—¬ì£¼ê¸° */
        .screen.active {
            display: flex; /* flexboxë¡œ ë ˆì´ì•„ì›ƒ */
        }
        
        /* ë°˜ì‘í˜• ê¸€ê¼´ í¬ê¸° */
        .font-responsive-title {
            font-size: clamp(1.5rem, 5vw, 3rem);
        }
        
        .font-responsive-text {
            font-size: clamp(1rem, 3vw, 1.75rem);
        }

        .font-responsive-small {
            font-size: clamp(0.875rem, 2.5vw, 1.25rem);
        }

        /* í…ìŠ¤íŠ¸ í…Œë‘ë¦¬ íš¨ê³¼ (ê·¸ë¦¼ìë¡œ ëŒ€ì²´) */
        .text-outline {
            text-shadow: 
                -1px -1px 0 #000,  
                 1px -1px 0 #000,
                -1px  1px 0 #000,
                 1px  1px 0 #000,
                 -2px -2px 5px rgba(0,0,0,0.5),
                 2px  2px 5px rgba(0,0,0,0.5);
        }

        .text-shadow-soft {
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* ë“œë˜ê·¸ ê°€ëŠ¥í•œ ì•„ì´í…œ */
        .draggable {
            touch-action: none; /* ëª¨ë°”ì¼ í„°ì¹˜ ë“œë˜ê·¸ ì§€ì› */
            user-select: none; /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
        }

        /* ì¹ íŒ ë“œë ì˜ì—­ */
        #chalkboard-dropzone {
            min-height: 150px; /* ìµœì†Œ ë†’ì´ */
            border: 4px dashed #4a5568; /* ì ì„  í…Œë‘ë¦¬ */
            background-color: #1a202c; /* ì–´ë‘ìš´ ë°°ê²½ */
        }

        /* ì¹ íŒì— ë“œëëœ ì•„ì´í…œ */
        .chalk-item {
            cursor: move;
            padding: 0.5rem 1rem;
            background-color: #e2e8f0;
            color: #1a202c;
            border-radius: 0.25rem;
            margin: 0.25rem;
            font-size: clamp(1.25rem, 4vw, 2rem);
            border: 2px solid #a0aec0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 10;
        }

        /* ë“œë˜ê·¸ í”Œë ˆì´ìŠ¤í™€ë” */
        .drag-placeholder {
            width: 60px; /* ì¹ íŒ ì•„ì´í…œ í¬ê¸°ì™€ ìœ ì‚¬í•˜ê²Œ */
            height: 60px; /* ì¹ íŒ ì•„ì´í…œ ë†’ì´ì™€ ìœ ì‚¬í•˜ê²Œ (íŒ¨ë”© ê³ ë ¤) */
            margin: 0.25rem;
            border: 2px dashed #9ca3af; /* gray-400 */
            background-color: rgba(75, 85, 99, 0.2); /* gray-600 with transparency */
            border-radius: 0.25rem;
            flex-shrink: 0; /* í¬ê¸° ìœ ì§€ */
            box-sizing: border-box; /* í¬ê¸° ê³„ì‚° */
        }

        /* ëª¨ë‹¬ ë°°ê²½ */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.75); /* ë°˜íˆ¬ëª… ë°°ê²½ */
        }

        /* ì„¤ì • ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒ ì‹œ í•˜ìœ„ ì˜µì…˜ ë³´ì´ê¸° */
        input[type="radio"]:checked + label + .settings-options {
            display: block;
        }
        .settings-options {
            display: none;
            padding-left: 1.5rem;
            padding-top: 0.5rem;
            border-left: 2px solid #4a5568;
            margin-left: 0.5rem;
        }
        
        /* ì¸ë²¤í† ë¦¬ ì»¨í…Œì´ë„ˆ (3ì¤„ ë†’ì´ ê³ ì • ë° ìŠ¤í¬ë¡¤) */
        #inventory-container {
            max-height: 240px; /* ëŒ€ëµ 3ì¤„ ë†’ì´ (item height + margin + padding) */
            overflow-y: auto; /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ë°” */
            overflow-x: hidden; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ë°”ëŠ” ìˆ¨ê¹€ */
            align-content: flex-start; /* ì•„ì´í…œì´ ìœ„ì—ì„œë¶€í„° ì±„ì›Œì§€ë„ë¡ */
        }

        /* ì¸ë²¤í† ë¦¬ ì•„ì´í…œ */
        .inventory-item {
            cursor: move;
            padding: 0.5rem 1rem;
            background-color: #4a5568; /* bg-gray-600 */
            color: #fff;
            border-radius: 0.25rem;
            margin: 0.25rem;
            font-size: clamp(1.25rem, 4vw, 2rem);
            border: 2px solid #a0aec0; /* gray-400 */
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            flex-shrink: 0; /* ì•„ì´í…œì´ ì¤„ë°”ê¿ˆë˜ì§€ ì•Šë„ë¡ */
        }

    </style>
</head>
<body class="bg-gray-900 text-white overflow-hidden">

    <div id="opening-screen" class="screen active flex-col items-center justify-center p-4 text-center">
        <h1 class="font-responsive-title text-shadow-soft mb-8">ì‚¬ì¹™ì—°ì‚° ë¹Œë“œ ê²Œì„</h1>
        <p class="font-responsive-text mb-4">ì°¸ê°€ í•™ìƒë“¤ì˜ ì´ë¦„ì„ ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”.</p>
        <textarea id="student-names-input" class="w-full max-w-lg h-40 p-4 rounded-lg bg-gray-800 border border-gray-700 text-white font-responsive-text mb-6" placeholder="ì˜ˆì‹œ) ê¹€ì² ìˆ˜, ì´ì˜í¬, ë°•ì§€ì„±"></textarea>
        <div class="flex flex-col gap-4">
            <button id="start-game-btn" class="text-white py-2 px-10 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-green-600 hover:bg-green-700 text-2xl">ê²Œì„ ì‹œì‘</button>
            <button id="start-study-btn" class="text-white py-2 px-10 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-blue-600 hover:bg-blue-700 text-2xl">ê³µë¶€ ì‹œì‘</button>
        </div>
    </div>

    <div id="main-screen" class="screen flex-col p-4">
        <header class="w-full flex justify-between items-center pb-4 border-b-2 border-gray-700 mb-4">
            <button id="goto-opening-btn" class="text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-gray-600 hover:bg-gray-700">ğŸ  ì²˜ìŒìœ¼ë¡œ</button>
            <h1 class="font-responsive-title text-shadow-soft">í•™ìƒ ëª…ë‹¨</h1>
            <button id="open-settings-btn" class="text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-yellow-500 hover:bg-yellow-600 text-black">âš™ï¸ ì„¤ì •</button>
        </header>
        <div id="student-list-container" class="w-full flex flex-wrap gap-2 p-2">
            </div>
        <div class="flex-grow flex items-center justify-center">
            <p class="font-responsive-text text-gray-400">í•™ìƒ ì´ë¦„ì„ í´ë¦­í•˜ì—¬ ê²Œì„ì„ ì§„í–‰í•˜ì„¸ìš”.</p>
        </div>
    </div>
    
    <div id="draw-screen" class="screen flex-col p-4">
        <header class="w-full flex justify-between items-center pb-4 border-b-2 border-gray-700 mb-4">
            <button class="home-btn text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-gray-600 hover:bg-gray-700">ğŸ  ë©”ì¸ìœ¼ë¡œ</button>
            <h1 id="draw-student-name" class="font-responsive-title text-shadow-soft">í•™ìƒ ì´ë¦„</h1>
            <button id="open-settings-draw-btn" class="text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-yellow-500 hover:bg-yellow-600 text-black">âš™ï¸ ì„¤ì •</button>
        </header>

        <div class="flex-grow flex flex-col md:flex-row items-center justify-around gap-4 md:gap-8">
            <div id="number-box" class="w-2/5 h-64 md:h-80 border-4 border-dashed rounded-2xl shadow-2xl flex flex-col items-center justify-center cursor-pointer transition-all duration-300 ease-in-out hover:shadow-inner hover:scale-102 border-cyan-400 bg-cyan-900/50 hover:bg-cyan-900/80">
                <h2 class="font-responsive-title mb-4">ìˆ«ì ë½‘ê¸°</h2>
                <p class="font-responsive-text">(í´ë¦­)</p>
            </div>
            <div id="operator-box" class="w-2/5 h-64 md:h-80 border-4 border-dashed rounded-2xl shadow-2xl flex flex-col items-center justify-center cursor-pointer transition-all duration-300 ease-in-out hover:shadow-inner hover:scale-102 border-amber-400 bg-amber-900/50 hover:bg-amber-900/80">
                <h2 class="font-responsive-title mb-4">ê¸°í˜¸ ë½‘ê¸°</h2>
                <p class="font-responsive-text">(í´ë¦­)</p>
            </div>
        </div>
        
        <div class="w-full max-w-4xl mx-auto mt-4 p-3 bg-gray-800 rounded-lg">
            <h3 class="font-responsive-small text-center mb-2">ì´ë²ˆì— ë½‘ì€ ê²ƒ:</h3>
            <div id="current-draws-container" class="flex flex-wrap gap-2 justify-center min-h-[30px]">
                </div>
        </div>

        <div id="draw-result" class="fixed bottom-80 left-1/2 -translate-x-1/2 bg-gray-800 border-2 border-white text-white p-12 rounded-2xl shadow-2xl text-9xl text-outline opacity-0 transition-all duration-500 ease-in-out scale-50">
            </div>
    </div>

    <div id="equation-screen" class="screen flex-col p-4 h-full">
        <header class="w-full flex justify-between items-center pb-4 border-b-2 border-gray-700 mb-4">
            <button class="home-btn text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-gray-600 hover:bg-gray-700">ğŸ  ë©”ì¸ìœ¼ë¡œ</button>
            <h1 id="equation-student-name" class="font-responsive-title text-shadow-soft">í•™ìƒ ì´ë¦„</h1> <button id="calculate-btn" class="text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-green-600 hover:bg-green-700">ê²°ê³¼ ë³´ê¸°</button>
        </header>

        <div class="mb-4">
            <h2 class="font-responsive-text mb-2">ì¸ë²¤í† ë¦¬ (ë“œë˜ê·¸í•˜ì„¸ìš” / ì¹ íŒ ì•„ì´í…œì„ ì—¬ê¸°ì— ë“œë¡­í•˜ì—¬ ë˜ëŒë¦¬ê¸°)</h2>
            <div id="inventory-container" class="w-full bg-gray-800 p-4 rounded-lg flex flex-wrap gap-2 min-h-[80px] border-2 border-dashed border-gray-700">
                </div>
        </div>

        <div class="flex-grow flex flex-col">
            <h2 class="font-responsive-text mb-2">ì¹ íŒ (ì•„ì´í…œì„ ì—¬ê¸°ì— ë“œë¡­í•˜ì„¸ìš”)</h2>
            <div id="chalkboard-dropzone" class="w-full flex-grow p-4 rounded-lg flex flex-wrap items-start content-start relative">
                <button id="clear-chalkboard-btn" class="absolute top-2 right-2 text-white py-1 px-3 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-red-600 hover:bg-red-700 text-sm">ëª¨ë‘ ì§€ìš°ê¸°</button>
            </div>
        </div>

        <div id="result-display" class="w-full mt-4 p-4 bg-gray-800 rounded-lg text-center">
            <h3 class="font-responsive-title text-yellow-400">= ?</h3>
        </div>
    </div>

    <div id="student-context-menu" class="hidden fixed bg-gray-700 border border-gray-600 rounded-lg shadow-2xl z-50 p-2 flex flex-col gap-2">
        <button id="goto-draw-btn" class="w-full text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-blue-600 hover:bg-blue-700">ì•„ì´í…œ ë½‘ê¸°</button>
        <button id="goto-equation-btn" class="w-full text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-purple-600 hover:bg-purple-700">ë°©ì •ì‹ ë§Œë“¤ê¸°</button>
    </div>

    <div id="result-steps-modal" class="hidden fixed inset-0 z-50 modal-backdrop flex items-center justify-center p-4">
        <div class="bg-gray-800 w-full max-w-lg rounded-2xl shadow-2xl p-6 border-2 border-gray-700">
            <h2 class="font-responsive-title mb-6 text-center">ê³„ì‚° ê³¼ì •</h2>
            <div class="mb-4">
                <h3 class="font-responsive-text text-gray-400 mb-2">ì›ë³¸ ì‹:</h3>
                <p id="steps-expression" class="font-responsive-text bg-gray-700 p-4 rounded-lg text-white break-words"></p>
            </div>
            <div class="mb-4">
                <h3 class="font-responsive-text text-gray-400 mb-2">ê³„ì‚° ìˆœì„œ:</h3>
                <ul id="steps-list" class="list-disc list-inside pl-2 mb-4 space-y-1 text-gray-300 font-responsive-small">
                    </ul>
            </div>
            <hr class="border-gray-600 my-4">
            <div class="mb-6">
                <h3 class="font-responsive-text text-gray-400 mb-2">ê²°ê³¼:</h3>
                <p id="steps-result" class="font-responsive-title text-green-400 text-center p-2"></p>
            </div>
            <div class="flex justify-end">
                <button id="close-steps-btn" class="text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-gray-600 hover:bg-gray-700">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="hidden fixed inset-0 z-50 modal-backdrop flex items-center justify-center p-4">
        <div class="bg-gray-800 w-full max-w-2xl rounded-2xl shadow-2xl p-6 border-2 border-gray-700 max-h-[90vh] overflow-y-auto">
            <h2 class="font-responsive-title mb-6 text-center">ê²Œì„ ì„¤ì •</h2>
            
            <fieldset class="border-2 border-cyan-500 p-4 rounded-lg mb-6">
                <legend class="font-responsive-text px-2 text-cyan-400">ìˆ«ì ë½‘ê¸° ì„¤ì •</legend>
                <div class="mb-2">
                    <input type="radio" id="num-mode-range" name="num-mode" value="range" class="w-4 h-4 mr-1" checked>
                    <label for="num-mode-range" class="font-responsive-small">ë²”ìœ„ì—ì„œ ë½‘ê¸°</label>
                    <div class="settings-options">
                        <div class="flex flex-col md:flex-row gap-4 mb-4">
                            <div class="flex-1">
                                <label for="num-min" class="block font-responsive-small mb-1">ìµœì†Œ ìˆ«ì:</label>
                                <input type="number" id="num-min" class="w-full p-2 rounded bg-gray-700 border border-gray-600 text-white font-responsive-text" value="1">
                            </div>
                            <div class="flex-1">
                                <label for="num-max" class="block font-responsive-small mb-1">ìµœëŒ€ ìˆ«ì:</label>
                                <input type="number" id="num-max" class="w-full p-2 rounded bg-gray-700 border border-gray-600 text-white font-responsive-text" value="9">
                            </div>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="num-duplicates" class="w-5 h-5 mr-2 bg-gray-700 border-gray-600" checked>
                            <label for="num-duplicates" class="font-responsive-small">ìˆ«ì ì¤‘ë³µ ë½‘ê¸° í—ˆìš© (ë²”ìœ„ ë½‘ê¸° ì „ìš©)</label>
                        </div>
                    </div>
                </div>
                <div>
                    <input type="radio" id="num-mode-custom" name="num-mode" value="custom" class="w-4 h-4 mr-1">
                    <label for="num-mode-custom" class="font-responsive-small">ì»¤ìŠ¤í…€ ëª©ë¡ì—ì„œ ë½‘ê¸°</label>
                    <div class="settings-options">
                        <label for="num-custom" class="block font-responsive-small mb-1">ìˆ«ì ëª©ë¡ (ì‰¼í‘œë¡œ êµ¬ë¶„):</label>
                        <input type="text" id="num-custom" class="w-full p-2 rounded bg-gray-700 border border-gray-600 text-white font-responsive-text" placeholder="1, 5, 10, 20">
                        
                        <div class="mt-4">
                            <label class="block font-responsive-small mb-2">ì»¤ìŠ¤í…€ ëª©ë¡ ì ìš© ë²”ìœ„:</label>
                            <div class="flex gap-4 items-center mb-1">
                                <input type="radio" id="num-scope-student" name="num-scope" value="student" class="w-4 h-4 mr-1" checked>
                                <label for="num-scope-student" class="font-responsive-small">í•™ìƒë³„ í• ë‹¹ (ê°ì ëª©ë¡ ì†Œì§„)</label>
                            </div>
                            <div class="flex gap-4 items-center">
                                <input type="radio" id="num-scope-global" name="num-scope" value="global" class="w-4 h-4 mr-1">
                                <label for="num-scope-global" class="font-responsive-small">ì „ì²´ í•™ìƒ ê³µìœ  (ê³µìš© ëª©ë¡ ì†Œì§„)</label>
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>

            <fieldset class="border-2 border-amber-500 p-4 rounded-lg mb-6">
                <legend class="font-responsive-text px-2 text-amber-400">ì—°ì‚° ê¸°í˜¸ ë½‘ê¸° ì„¤ì •</legend>
                <div class="mb-2">
                    <input type="radio" id="op-mode-checklist" name="op-mode" value="checklist" class="w-4 h-4 mr-1" checked>
                    <label for="op-mode-checklist" class="font-responsive-small">ì²´í¬ë¦¬ìŠ¤íŠ¸ì—ì„œ ëœë¤ ë½‘ê¸° (ë¬´í•œ)</label>
                    <div class="settings-options">
                        <div id="op-checklist" class="grid grid-cols-3 md:grid-cols-5 gap-2">
                            </div>
                    </div>
                </div>
                <div class="mb-4">
                    <input type="radio" id="op-mode-custom" name="op-mode" value="custom" class="w-4 h-4 mr-1">
                    <label for="op-mode-custom" class="font-responsive-small">ì»¤ìŠ¤í…€ ëª©ë¡ì—ì„œ ë½‘ê¸° (ìˆ˜ëŸ‰ ì œí•œ)</label>
                    <div class="settings-options">
                        <label for="op-custom" class="block font-responsive-small mb-1">ê¸°í˜¸ ëª©ë¡ (ì‰¼í‘œë¡œ êµ¬ë¶„):</label>
                        <input type="text" id="op-custom" class="w-full p-2 rounded bg-gray-700 border border-gray-600 text-white font-responsive-text" placeholder="+, +, -, Ã—, ( )">
                        
                        <div class="mt-4">
                            <label class="block font-responsive-small mb-2">ì»¤ìŠ¤í…€ ëª©ë¡ ì ìš© ë²”ìœ„:</label>
                            <div class="flex gap-4 items-center mb-1">
                                <input type="radio" id="op-scope-student" name="op-scope" value="student" class="w-4 h-4 mr-1" checked>
                                <label for="op-scope-student" class="font-responsive-small">í•™ìƒë³„ í• ë‹¹ (ê°ì ëª©ë¡ ì†Œì§„)</label>
                            </div>
                            <div class="flex gap-4 items-center">
                                <input type="radio" id="op-scope-global" name="op-scope" value="global" class="w-4 h-4 mr-1">
                                <label for="op-scope-global" class="font-responsive-small">ì „ì²´ í•™ìƒ ê³µìœ  (ê³µìš© ëª©ë¡ ì†Œì§„)</label>
                            </div>
                        </div>
                        
                        <hr class="border-gray-600 my-4">
                        <div class="flex items-center">
                            <input type="checkbox" id="op-random" class="w-5 h-5 mr-2 bg-gray-700 border-gray-600" checked>
                            <label for="op-random" class="font-responsive-small">ì»¤ìŠ¤í…€ ëª©ë¡ ë½‘ê¸° ì‹œ ëœë¤ìœ¼ë¡œ ë½‘ê¸°</label>
                        </div>
                        <p class="font-responsive-small mt-1 text-gray-400">(í•´ì œ ì‹œ, ëª©ë¡ ìˆœì„œëŒ€ë¡œ ë‚˜ì˜µë‹ˆë‹¤)</p>
                    </div>
                </div>
            </fieldset>

            <fieldset class="border-2 border-gray-500 p-4 rounded-lg mb-6">
                <legend class="font-responsive-text px-2 text-gray-400">ì¹ íŒ ì„¤ì •</legend>
                <div class="flex items-center">
                    <input type="checkbox" id="chalk-concat-nums" class="w-5 h-5 mr-2 bg-gray-700 border-gray-600">
                    <label for="chalk-concat-nums" class="font-responsive-small">ìˆ«ì ìë™ ë¶™ì´ê¸° (ì˜ˆ: 2, 6 â†’ 26)</label>
                </div>
            </fieldset>

            <div class="flex justify-end gap-4 mt-8">
                <button id="close-settings-btn" class="text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-gray-600 hover:bg-gray-700">ë‹«ê¸°</button>
                <button id="save-settings-btn" class="text-white py-2 px-6 rounded-lg shadow-lg transition-transform duration-200 ease-in-out font-responsive-small hover:shadow-xl hover:scale-105 bg-green-600 hover:bg-green-700">ì„¤ì • ì €ì¥</button>
            </div>
        </div>
    </div>

    <audio id="click-sound" preload="auto">
        <source src="data:audio/mp3;base64,//vUZAAABexdUh1nIAJIglaSp7AAJ4GZMBnvAAFTieJPNcAAAALldqSh2FyJCIBFBGuM4ZOjIZjByXHloeVxzNBigVFN6A4HDUKAwiRC7GuQ5YqRiMRiMRikw3UpKSklEYjEYjEbjcvp8/1hhT09PT09PT09PLIxGKSxh+dPSUlJhhhhhhT09PT0+ef4U9Pbzzzz7rPv4Yf/4U9PTyuNxunp+50+denp8888MMMKlJSUlJG43T5/+GFinp6enp6e33Venp6ent59///CpSUlJSS+np7eesKSkl9PT09vMPDAACmrvimoafNNRthc2k/C4Mor4DuDfTYA4D1dNK4hiO8Zn8BwYLOvdwMCcHxwPzkSOlHa/BCCHLvghBD/BD8MQx/hj5QEPl38EDArBaMEsOgwagYTAdBUFAABwCAwdCsTJHTcMG8CIwCgjwEA2YA4CJq6kYHi8P0YOQlBp/3KGAcBMIBwzXaESMDwO88RlFzJXAsNl0ywyDQpDCOCBMAcEgwQQHx4Ewus1cIDgQ5KGmCIBqYAIDxgcgQSV/pc1NqTTAqBGYFIIxgZgYGBmAUlO+sMzD413biMqorxgKACuaAAFzAeAdMBoAsuTKYzllKqanpJr7V9eqtjaonAYAKQy63NZW5TDUH8zx/nNtaQRAkAcQAEKJs0BIAyVMgn4BLm02v+rTdtfruLZpS/C7nTUqLLJ9RqU/qahqL49/f/zm8cu9/xGAkYAwBoXACfyOONBa0i1ShU1KrVyNTMxa7/Msf7/7xx//1/O/+UpdG/GblxnrHLCtz5yqmaV/+PIhoPHP/1xKgAABEICsaibctUrcrE9RxxXU320m+HAwsjNxYgQAkxGDzDoLOZD0z2KDKpiBQugJ342nnNvy/uOp/DCtlalAfAglI85hot9xcr/BD2/0HymR/z/y3eCAABrtGBjsQxEJQcAgIBUkCIdB0DC+YDAUYGhCqcWFwMAIqgKYehKGFSYXHSZmqYYXiQZljAxmKYDOYAIVZhDAImCQB2//vUZCKH6Gd1Sa93wAJfYjeC7WwAIg3VHK7pMcmPi93AzA2YFgDkDRIBZcSECNfC9cAR9rDBYNg9/XLksXpL8Qk7pv++7/tbepxI81+Fu248von3n4Yft24vcljsM4fyHI3N508eiliHLMonaZyIpDksqVJRGIYlmdy9VqVuW6SkjEspLFak5MSy7nuVyyUSzeXK9vVS9lh3Cpuv/1OW9WOY/hzKkxypLGFTl7Ck3WsZUmGdvdSk5hhj3+3KTlPfwsbuVLt+v3CUSy7fq096pLK/bFft7P6/Zic5hv7du1hXp+8oLF2N9u09bSgABKc5EbhA36gT9Voi78sgOaeBdTWguDMgBNBXM8vOHWDRx84pNMuRQhJTBL3P080jgWveldSvcKhx5oot4HIFy4PremMBA4rdCwQd/UCE4cm5wQZPp/Ke3X5w50f05AoINYxUGExwHsIG0EAWHAYYJgZDYgA8eAYLACBgFBACmDgbmJAlhgwmARUmmBRmh0GnBSbgglD/nA4KlEZBGZwmBjIUFgIq0EvsBhTjrCstcFyotTTMZlCwymRcJCSWVQ1kEPVnCVNCnRfxQJpz7KBMul1NHmvRJHpOpr0bjLKWtMOROSKYk5VHZtuEqZp0NRa7SvqylhzXnKkVUKhkKgBRCpqStFQAgBJlwChlgqGYHQSNf5JFNDGElmxSwiaqSz1UKTSpETSWRIlxSFQsKhUTSkmSrORRl7Cpm5TiIQAgBDJKwQuWIg0ikRHWxTVoUKwqFTPWeyFiZqxECSMUmUSzUeWE0SwaJtyMYkJKhqSIULgCnpye41db63qnINZQtkICDInQ65F7S2mlM7Vu2eRrkvz9oyhXCqh5YGj1IoDUmGQo+IocHiY9JOAgWMkmwCa41LqCVzH+wPCr4eDbHzRlw1gTQPMqYP1ovFSxaOaeCzuMSQoydENTMICHMQMFIwxAyzAmA8MB8Bk0IrMHODDxUAg4sEK3jgQChMxAGKHI3ZnNnwgvUG2nodSAo/EiwOIkzXfU//vUZCAIh/11OoPbYXJrToaQPCMaW53CsS6wecklrBXYEI48aT+Ym2YPgRODs4LWRuFoSSsDo4B9AOwkhMQRqHsiLz8SS8rcjd/qtPrXSsbgdBYaBeHo5J1OGQSg6JBbUFoQS4RhBKZFEpOpgPiSXkiOvPMtQwJm3IUhsJJSVadNoj5mn2TJ0RklUH0PZuVybMsYhnA/BKPBREkvKCcXTUyfPaLswyHk8HZKakpCR0hRGUMW7WB5a0huHyZ89OoaPurjpuKy6HtYPR6J4eiEXThOcKSUdlk6hYjZeOUJepMkrDawVJaLT0QUJ53xBnLlJq6zzqNDJjqo0bXNf+a8OspMa+Sw1hqQZDhrG61WNSa1DWGu2axgqN8NY1Jo1WHS2cTDWepMYUhVkarGpdJqUNWjlw1z1hqR7RqvGoVxMOGqAUY1JnWdjrDWcNeChUqrVX35tTbxnm/5usIhouCxk8Dpi6BQcOpQKYYECNjMYPdVsjQoZcV9Y+uVvaZ3nChU2/LSl3OdKVhVAWCvzAMulbDUhVStNf2GR1sthQhCI4ggdEk7EEfZ9yNoeiy4qHonHwTDsdnwhE5PTmUw5GICQOoiqYiSACOvmR0JROZMaTBZ5kxrSz64+nddZMSbjQlGScknq1rDJKYu97Ik+taXWMlx0I0BkzXKGR80JLj3W9CLSc+tPteXQak06Pnu+1r98C6Oms8ymVQrmXFWNAwr+xqXqesAhWGAncmxkQLCLCHfF/ov/8n4QhXExPxBxPRQrmEInyEJlwook+qr/GZjs6qkewU5qvtcMKY/gZVJqSiSlI4x9Y17BTN9VQq8jMGOEgVg1grVYEqtVHXkJUYQoTpiHAUmFWEYZLmcYYbE4FDoGwBqhVQYc5JCsghYCyFSInojFzUxAFoGNLaBEkEqqizUTlzhiQqRE8SCXWTfW8XdVUL9FuVKEgkJKiTUEVl9pmoJl5qtRWVRbdIljCzkhV8KcqCqLOIoMxljqgTR2gKbLAuOpqz5qapWjL/R9SOZ//vUZEUA+ot1nzPawJABIBAALAABLqXWgC9rBYgAADSAAAAEwiksCxRIpZLJErkjWdo+rBM3TBWCZenSkcyhK5VVpimy8WuKXJUtLUtVua+rlaTO1YUqmkKxK2uQwZaLWFrJytzV6uZ22SsCcNeqczcF7LldBtlyugzZOVu6/WHPG3rDnjZqpk2BoTDXoe5hrwNCUxbG1Fhz4vkzp629WGbI5zEXqe9nLYnOWFbC2ZiT0wI15ur5LubE57XY9Pw7HqN/Y7IIeiMsh6IzkPR6fh2JU8ViU/DszOS6I0kWiNJGpVTy2JU8tlVuzkKwPNXA8cycRPzBTB0MOIN4wZARzCfCROCgPZwAWk6lg1gc4c004A3EIHQTXuQh0ahYHRjRLBpaZtOTKjKIihIcfiYzXsbGaMDXDPcW2ZKC2DG0XAYYiVwIwOoCVhkwYgIgFkBjAucMeFiBDBCUMWXkDHiIAQQVCEHQYBxEdwcdKcHHSUBwE7wcNVAt4xsIAo2WvUeLiLZLjr6LiLSLiMhLxsiLwNJLxu0Xja0gEaygHXcWQWKWTTpLJrqLKMFLLrWLYMVLYL9LZr+LgMVLhreLuKuLgKcF11xl1FuIJ1foZrPQwWYhmqNDBSCPaZiN6k0qE+E00+00E1FDE1E9011VE1Fg0114JJrAJWLLSvXwj4wtH9jKP7GEfGNo/tUR8bKj40VFNnyKDdUU25IoMqRQcFItwkiHBSLf5ItykxH9XfDy7IdXe/K74eXZArD4GYZBzDISw+FMMhLD4Uwx82GPYyt72UPYyt12lvOyh5GlvO0iES+vIkxBTUUzLjEwMKqqqqqqqqAAABVajhntjsUHzfpxTLAZj4/DngzvZzXDjn3DMCjgxgdDNQxDlhn1A+c5dKOmapFk02KLmqpRE00IpmzJEM0RImmFQ0oCJFkhUgcoQiDjBYYsEKiFhBYaFoBcNBAqAxwWOENEJAc4YGBmjgQU0dAEGQZCCoNBwhEFDZEEICm8DhJ2goKqACMo4ChLLLWr//vUZEeP+192Hsu6wMAAAA0gAAABAAABpAAAACAAADSAAAAEYLjMLQVYwkS0QvEyMvCyAuUwMtK0stqzhAM1tAK1xIpy1AnfSFcRCU09CSywuE4iAZt0hW8SGc9BKuFHlbpe5cRdVcJdZb4MC1Muqt1DJZyGKfKaSayqyayaKfKaSfSaKzUMl+pVJrKqpqqrJXLJQVYShqtpK5fKVq+lLlgVdLxTBY0j81VFFnheJniAJmaKLdEUm7pgtgWK8CRThpEuAis1su64aAVyGdRtnMscqXu1L3JljWou1mKMOljWpG1mQO1J3ZkL6yF2pE7MhcKTtZk7gwl2oGfWBZVLquNMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//vUZAAP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAETEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV" type="audio/mp3">
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- ì „ì—­ ìƒíƒœ ê´€ë¦¬ ---
            let isStudyMode = false; // [ì¶”ê°€] ê³µë¶€ ëª¨ë“œ í”Œë˜ê·¸
            let gameState = {
                currentView: 'opening-screen',
                students: {}, 
                currentStudent: null, 
                settings: {
                    number: {
                        mode: 'range', 
                        min: 1,
                        max: 9,
                        allowDuplicates: true,
                        customList: [], 
                        customScope: 'student', 
                    },
                    operator: {
                        mode: 'checklist', 
                        checklist: ['(', ')', '+', '-', 'Ã—', 'Ã·'], 
                        customList: [], 
                        random: true, 
                        customScope: 'student', 
                    },
                    chalkboard: {
                        concatenateNumbers: false
                    }
                },
                availableOperators: ['+', '-', 'Ã—', 'Ã·', '( )', '='], 
                drawBoxCustomOperators: [], 
                drawBoxCustomNumbers: [],
                // [ì¶”ê°€] ê³µë¶€ ëª¨ë“œ ì „ìš© ìƒíƒœ
                studyMode: {
                    inventoryItems: [],
                    chalkboard: []
                }
            };

            // --- DOM ìš”ì†Œ ìºì‹± ---
            const screens = document.querySelectorAll('.screen');
            const openingScreen = document.getElementById('opening-screen');
            const mainScreen = document.getElementById('main-screen');
            const drawScreen = document.getElementById('draw-screen');
            const equationScreen = document.getElementById('equation-screen');

            const studentNamesInput = document.getElementById('student-names-input');
            const startGameBtn = document.getElementById('start-game-btn');
            const startStudyBtn = document.getElementById('start-study-btn'); // [ì¶”ê°€]
            const studentListContainer = document.getElementById('student-list-container');
            const gotoOpeningBtn = document.getElementById('goto-opening-btn'); 
            
            const contextMenu = document.getElementById('student-context-menu');
            const gotoDrawBtn = document.getElementById('goto-draw-btn');
            const gotoEquationBtn = document.getElementById('goto-equation-btn');

            const homeBtns = document.querySelectorAll('.home-btn');
            const drawStudentName = document.getElementById('draw-student-name');
            const numberBox = document.getElementById('number-box');
            const operatorBox = document.getElementById('operator-box');
            const drawResult = document.getElementById('draw-result');
            const currentDrawsContainer = document.getElementById('current-draws-container'); 

            const equationStudentName = document.getElementById('equation-student-name');
            const inventoryContainer = document.getElementById('inventory-container');
            const chalkboard = document.getElementById('chalkboard-dropzone');
            const clearChalkboardBtn = document.getElementById('clear-chalkboard-btn');
            const calculateBtn = document.getElementById('calculate-btn');
            const resultDisplay = document.getElementById('result-display');
            
            const resultStepsModal = document.getElementById('result-steps-modal');
            const closeStepsBtn = document.getElementById('close-steps-btn');
            const stepsExpression = document.getElementById('steps-expression');
            const stepsResult = document.getElementById('steps-result');
            const stepsList = document.getElementById('steps-list'); 

            const settingsModal = document.getElementById('settings-modal');
            const openSettingsBtns = document.querySelectorAll('#open-settings-btn, #open-settings-draw-btn');
            const closeSettingsBtn = document.getElementById('close-settings-btn');
            const saveSettingsBtn = document.getElementById('save-settings-btn');
            const numModeRange = document.getElementById('num-mode-range');
            const numModeCustom = document.getElementById('num-mode-custom');
            const numMinInput = document.getElementById('num-min');
            const numMaxInput = document.getElementById('num-max');
            const numDuplicatesInput = document.getElementById('num-duplicates');
            const numCustomInput = document.getElementById('num-custom');
            const opModeChecklist = document.getElementById('op-mode-checklist');
            const opModeCustom = document.getElementById('op-mode-custom');
            const opChecklist = document.getElementById('op-checklist');
            const opCustomInput = document.getElementById('op-custom');
            const opRandomInput = document.getElementById('op-random');
            const chalkConcatNumsInput = document.getElementById('chalk-concat-nums');

            const numScopeStudent = document.getElementById('num-scope-student');
            const numScopeGlobal = document.getElementById('num-scope-global');
            const opScopeStudent = document.getElementById('op-scope-student');
            const opScopeGlobal = document.getElementById('op-scope-global');

            const clickSound = document.getElementById('click-sound');

            let currentDraggingElement = null; 
            let currentDragSourceContainer = null; 
            
            const dragPlaceholder = document.createElement('div');
            dragPlaceholder.className = 'drag-placeholder';
            let placeholderActive = false; 
            
            const studentButtonColors = [
                { bg: 'bg-blue-600', hover: 'hover:bg-blue-700' },
                { bg: 'bg-green-600', hover: 'hover:bg-green-700' },
                { bg: 'bg-red-600', hover: 'hover:bg-red-700' },
                { bg: 'bg-yellow-600', hover: 'hover:bg-yellow-700' },
                { bg: 'bg-indigo-600', hover: 'hover:bg-indigo-700' },
                { bg: 'bg-pink-600', hover: 'hover:bg-pink-700' },
                { bg: 'bg-teal-600', hover: 'hover:bg-teal-700' },
                { bg: 'bg-orange-600', hover: 'hover:bg-orange-700' },
            ];

            // --- ì˜¤ë””ì˜¤ ë¡œì§ ---
            function playClickSound() {
                if (clickSound) {
                    clickSound.currentTime = 0; 
                    clickSound.play().catch(e => console.error("Audio play failed:", e));
                }
            }

            document.addEventListener('click', (e) => {
                if (e.target.closest('button, [role="button"], .cursor-pointer, input[type="radio"], input[type="checkbox"]')) {
                    playClickSound();
                }
            }, true); 

            // --- í™”ë©´ ì „í™˜ ë¡œì§ ---
            function showScreen(screenId) {
                screens.forEach(screen => {
                    if (screen.id === screenId) {
                        screen.classList.add('active');
                    } else {
                        screen.classList.remove('active');
                    }
                });
                gameState.currentView = screenId;
                hideContextMenu();
            }

            // --- ê²Œì„ ì‹œì‘ ---
            startGameBtn.addEventListener('click', () => {
                isStudyMode = false; // [ì¶”ê°€] ê²Œì„ ëª¨ë“œ í”Œë˜ê·¸ ì„¤ì •
                const names = studentNamesInput.value.split(',')
                    .map(name => name.trim())
                    .filter(name => name.length > 0);
                
                if (names.length === 0) {
                    showTempMessage(studentNamesInput, 'í•™ìƒ ì´ë¦„ì„ 1ëª… ì´ìƒ ì…ë ¥í•˜ì„¸ìš”!', 'red');
                    return;
                }
                
                gameState.students = {};
                names.forEach(name => {
                    gameState.students[name] = { 
                        inventoryItems: [], 
                        chalkboard: [], 
                        privateCustomNumPool: [], 
                        privateCustomOpPool: []   
                    };
                });
                
                populateCustomPools(); 
                renderStudentList();
                showScreen('main-screen');
            });

            // [ì¶”ê°€] ê³µë¶€ ì‹œì‘ ë²„íŠ¼ ë¦¬ìŠ¤ë„ˆ
            startStudyBtn.addEventListener('click', () => {
                isStudyMode = true; // ê³µë¶€ ëª¨ë“œ í”Œë˜ê·¸ ì„¤ì •
                
                // ê³µë¶€ ëª¨ë“œìš© ì¸ë²¤í† ë¦¬ ìƒì„± (ìµœì´ˆ 1íšŒë§Œ)
                if (gameState.studyMode.inventoryItems.length === 0) {
                    const studyItems = [];
                    // 0~9 ìˆ«ì
                    for (let i = 0; i <= 9; i++) {
                        studyItems.push({ type: 'number', value: i, id: 'study_num_' + i });
                    }
                    // ì‚¬ì¹™ì—°ì‚° ë° ê´„í˜¸
                    ['+', '-', 'Ã—', 'Ã·', '(', ')'].forEach((op, i) => {
                        studyItems.push({ type: 'operator', value: op, id: 'study_op_' + i });
                    });
                    gameState.studyMode.inventoryItems = studyItems;
                }
                // ì¹ íŒì€ ë¹„ìš°ê³  ì‹œì‘
                gameState.studyMode.chalkboard = [];
                
                equationStudentName.textContent = "ì—°ìŠµ ì¹ íŒ"; // ì œëª© ë³€ê²½
                renderStudyInventory();  // ê³µë¶€ ëª¨ë“œ ì¸ë²¤í† ë¦¬ ë Œë”ë§
                renderStudyChalkboard(); // ê³µë¶€ ëª¨ë“œ ì¹ íŒ ë Œë”ë§
                showScreen('equation-screen');
            });

            gotoOpeningBtn.addEventListener('click', () => {
                if (confirm('ì²˜ìŒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ë©´ ëª¨ë“  í•™ìƒ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. (ê²Œì„ì„ ë‹¤ì‹œ ì‹œì‘í•´ì•¼ í•¨)\nì •ë§ ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    showScreen('opening-screen');
                }
            });

            // --- í•™ìƒ ëª©ë¡ ë Œë”ë§ ---
            function renderStudentList() {
                studentListContainer.innerHTML = '';
                const studentNames = Object.keys(gameState.students);
                studentNames.forEach((name, index) => {
                    const colorIndex = index % studentButtonColors.length;
                    const color = studentButtonColors[colorIndex];
                    
                    const btnClasses = `inline-block mr-2 mb-2 flex-shrink-0 text-white py-4 px-8 rounded-lg shadow-lg transition-transform duration-200 ease-in-out hover:shadow-xl hover:scale-105 ${color.bg} ${color.hover} font-responsive-title`;
                    
                    const chip = document.createElement('button');
                    chip.className = btnClasses;
                    chip.textContent = name;
                    chip.addEventListener('click', (e) => {
                        e.stopPropagation();
                        isStudyMode = false; // [ì¶”ê°€] í•™ìƒ í´ë¦­ ì‹œ ê²Œì„ ëª¨ë“œë¡œ ì „í™˜
                        gameState.currentStudent = name;
                        showContextMenu(e.clientX, e.clientY);
                    });
                    studentListContainer.appendChild(chip);
                });
            }

            // --- ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ---
            function showContextMenu(x, y) {
                const menuWidth = contextMenu.offsetWidth || 150;
                const menuHeight = contextMenu.offsetHeight || 100;
                const docWidth = document.documentElement.clientWidth;
                const docHeight = document.documentElement.clientHeight;

                let left = x;
                let top = y;

                if (x + menuWidth > docWidth) left = docWidth - menuWidth - 5;
                if (y + menuHeight > docHeight) top = docHeight - menuHeight - 5;
                
                contextMenu.style.left = `${left}px`;
                contextMenu.style.top = `${top}px`;
                contextMenu.classList.remove('hidden');
            }

            function hideContextMenu() {
                contextMenu.classList.add('hidden');
            }

            document.body.addEventListener('click', hideContextMenu);

            gotoDrawBtn.addEventListener('click', () => {
                isStudyMode = false; // [ì¶”ê°€]
                drawStudentName.textContent = gameState.currentStudent;
                currentDrawsContainer.innerHTML = '';
                showScreen('draw-screen');
            });

            gotoEquationBtn.addEventListener('click', () => {
                isStudyMode = false; // [ì¶”ê°€]
                equationStudentName.textContent = gameState.currentStudent;
                renderInventory();
                renderChalkboard(); 
                showScreen('equation-screen');
            });

            homeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // [ìˆ˜ì •] ëª¨ë“œì— ë”°ë¼ ë³µê·€ í™”ë©´ ë³€ê²½
                    if (isStudyMode) {
                        showScreen('opening-screen');
                    } else {
                        showScreen('main-screen');
                    }
                });
            });

            // --- ë½‘ê¸° í™”ë©´ ë¡œì§ (ê²Œì„ ëª¨ë“œ ì „ìš©) ---
            numberBox.addEventListener('click', () => {
                if (isStudyMode) return; // ê³µë¶€ ëª¨ë“œì—ì„œëŠ” ì‘ë™ ì•ˆ í•¨
                const student = gameState.students[gameState.currentStudent];
                const { mode, min, max, allowDuplicates, customScope } = gameState.settings.number;

                let num;
                let sourcePool = [];
                let availableNumbers = [];

                if (mode === 'range') {
                    for (let i = min; i <= max; i++) sourcePool.push(i);
                    availableNumbers = [...sourcePool];
                    if (!allowDuplicates) {
                        const numbersInInventory = student.inventoryItems
                            .filter(item => item.type === 'number')
                            .map(item => item.value);
                        availableNumbers = sourcePool.filter(n => !numbersInInventory.includes(n));
                    }
                } else { 
                    if (customScope === 'student') {
                        availableNumbers = [...student.privateCustomNumPool];
                    } else { 
                        availableNumbers = [...gameState.drawBoxCustomNumbers];
                    }
                }

                if (availableNumbers.length === 0) {
                    const msg = mode === 'range' ? 'ë” ì´ìƒ ë½‘ì„ ìˆ˜ ìˆëŠ” ìˆ«ìê°€ ì—†ìŠµë‹ˆë‹¤!' : 'ì»¤ìŠ¤í…€ ìˆ«ì ëª©ë¡ì´ ë¹„ì—ˆìŠµë‹ˆë‹¤!';
                    showDrawResult(msg, false);
                    return;
                }
                
                const randIndex = Math.floor(Math.random() * availableNumbers.length);
                num = availableNumbers[randIndex];

                if (mode === 'custom') {
                    if (customScope === 'student') {
                        student.privateCustomNumPool.splice(randIndex, 1);
                    } else { 
                        gameState.drawBoxCustomNumbers.splice(randIndex, 1);
                    }
                }
                
                student.inventoryItems.push({ 
                    type: 'number', 
                    value: num, 
                    id: `num_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`, 
                    isInChalkboard: false
                });
                showDrawResult(num, true);
            });

            operatorBox.addEventListener('click', () => {
                if (isStudyMode) return; // ê³µë¶€ ëª¨ë“œì—ì„œëŠ” ì‘ë™ ì•ˆ í•¨
                const student = gameState.students[gameState.currentStudent];
                const { mode, checklist, random, customScope } = gameState.settings.operator;

                let opToDraw;
                let customPool = []; 

                if (mode === 'checklist') {
                    if (checklist.length === 0) {
                        showDrawResult('ì„ íƒëœ ê¸°í˜¸ê°€ ì—†ìŠµë‹ˆë‹¤!', false);
                        return;
                    }
                    const randIndex = Math.floor(Math.random() * checklist.length);
                    opToDraw = checklist[randIndex];
                    
                } else { 
                    if (customScope === 'student') {
                        customPool = student.privateCustomOpPool; 
                    } else { 
                        customPool = gameState.drawBoxCustomOperators; 
                    }

                    if (customPool.length === 0) {
                        showDrawResult('ì»¤ìŠ¤í…€ ê¸°í˜¸ ëª©ë¡ì´ ë¹„ì—ˆìŠµë‹ˆë‹¤!', false);
                        return;
                    }

                    if (random) {
                        const randIndex = Math.floor(Math.random() * customPool.length);
                        opToDraw = customPool.splice(randIndex, 1)[0]; 
                    } else {
                        opToDraw = customPool.shift(); 
                    }
                }

                if (opToDraw === '( )' || opToDraw === '(' || opToDraw === ')') { 
                    const openParenId = `op_${Date.now()}_open_${Math.random().toString(36).substr(2, 5)}`;
                    const closeParenId = `op_${Date.now()}_close_${Math.random().toString(36).substr(2, 5)}`;
                    
                    student.inventoryItems.push({ type: 'operator', value: '(', id: openParenId, isInChalkboard: false });
                    student.inventoryItems.push({ type: 'operator', value: ')', id: closeParenId, isInChalkboard: false });
                    showDrawResult('( )', true); 
                } else {
                    student.inventoryItems.push({ 
                        type: 'operator', 
                        value: opToDraw, 
                        id: `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`, 
                        isInChalkboard: false 
                    });
                    showDrawResult(opToDraw, true);
                }
            });

            function showDrawResult(item, success) {
                drawResult.textContent = item;
                if (success) {
                    drawResult.style.borderColor = '#34d399';
                    drawResult.style.color = '#34d399';
                    
                    const drawChip = document.createElement('span');
                    drawChip.className = 'font-responsive-small bg-gray-600 text-white py-1 px-3 rounded-full';
                    drawChip.textContent = item;
                    currentDrawsContainer.appendChild(drawChip);

                } else {
                    drawResult.style.borderColor = '#f87171';
                    drawResult.style.color = '#f87171';
                }
                
                drawResult.classList.remove('opacity-0', 'scale-50');
                drawResult.classList.add('opacity-100', 'scale-100');
                
                setTimeout(() => {
                    drawResult.classList.remove('opacity-100', 'scale-100');
                    drawResult.classList.add('opacity-0', 'scale-50');
                }, 1500);
            }
            
            // --- ë°©ì •ì‹ ë§Œë“¤ê¸° í™”ë©´ ë¡œì§ ---
            
            // [ì¶”ê°€] ê³µë¶€ ëª¨ë“œ ì¸ë²¤í† ë¦¬ ë Œë”ë§
            function renderStudyInventory() {
                inventoryContainer.innerHTML = '';
                gameState.studyMode.inventoryItems.forEach((itemData) => {
                    const itemEl = createInventoryItemElement(itemData, true); // isStudyMode = true
                    inventoryContainer.appendChild(itemEl);
                });
            }

            // [ì¶”ê°€] ê³µë¶€ ëª¨ë“œ ì¹ íŒ ë Œë”ë§
            function renderStudyChalkboard() {
                chalkboard.innerHTML = '';
                gameState.studyMode.chalkboard.forEach(itemData => {
                    const chalkItem = createChalkItem(itemData.value, itemData.id, itemData.type, true); // isStudyMode = true
                    chalkboard.appendChild(chalkItem);
                });
                chalkboard.appendChild(clearChalkboardBtn);
                updateParentheses();
            }

            // (ê²Œì„ ëª¨ë“œ) í•™ìƒ ì¸ë²¤í† ë¦¬ ë Œë”ë§
            function renderInventory() {
                inventoryContainer.innerHTML = '';
                const student = gameState.students[gameState.currentStudent];
                
                student.inventoryItems.forEach((itemData) => {
                    const itemEl = createInventoryItemElement(itemData, false); // isStudyMode = false
                    inventoryContainer.appendChild(itemEl);
                });
            }

            // [ìˆ˜ì •] isStudyMode íŒŒë¼ë¯¸í„° ì¶”ê°€
            function createInventoryItemElement(itemData, isStudyMode = false) {
                const itemEl = document.createElement('div');
                itemEl.className = 'draggable inventory-item'; 
                itemEl.textContent = itemData.value;
                itemEl.draggable = true; // ê³µë¶€ ëª¨ë“œì—ì„œëŠ” í•­ìƒ true
                itemEl.dataset.item = itemData.value;
                itemEl.dataset.id = itemData.id;
                itemEl.dataset.type = itemData.type;

                // [ìˆ˜ì •] ê²Œì„ ëª¨ë“œì¼ ë•Œë§Œ ë¹„í™œì„±í™” ë¡œì§ ì ìš©
                if (!isStudyMode && itemData.isInChalkboard) {
                    itemEl.classList.add('opacity-50', 'pointer-events-none');
                    itemEl.draggable = false;
                }

                itemEl.addEventListener('dragstart', (e) => {
                    // [ìˆ˜ì •] ëª¨ë“œì— ë”°ë¼ source ë³€ê²½
                    const source = isStudyMode ? 'study-inventory' : 'inventory';
                    e.dataTransfer.setData('text/plain', JSON.stringify({
                        value: itemData.value,
                        id: itemData.id,
                        type: itemData.type,
                        source: source
                    }));
                    currentDraggingElement = itemEl;
                    currentDragSourceContainer = inventoryContainer; 
                    // [ìˆ˜ì •] ê³µë¶€ ëª¨ë“œì—ì„œëŠ” íˆ¬ëª…ë„ ë³€ê²½ ì•ˆ í•¨ (ë¬´í•œ ì•„ì´í…œì´ë¯€ë¡œ)
                    if (!isStudyMode) {
                        setTimeout(() => itemEl.classList.add('opacity-20'), 0);
                    }
                });

                itemEl.addEventListener('dragend', () => {
                    if (!isStudyMode) {
                        itemEl.classList.remove('opacity-20');
                    }
                    removePlaceholder(); 
                    currentDraggingElement = null;
                    currentDragSourceContainer = null;
                });

                itemEl.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.stopPropagation();

                    // [ìˆ˜ì •] ê³µë¶€ ëª¨ë“œì—ì„œëŠ” ì¸ë²¤í† ë¦¬ ë‚´ ìˆœì„œ ë³€ê²½ ë¶ˆê°€
                    if (isStudyMode || itemEl === currentDraggingElement || currentDragSourceContainer !== inventoryContainer) {
                        return;
                    }

                    const rect = itemEl.getBoundingClientRect();
                    const midX = rect.left + rect.width / 2;
                    if (e.clientX < midX) {
                        inventoryContainer.insertBefore(dragPlaceholder, itemEl);
                    } else {
                        inventoryContainer.insertBefore(dragPlaceholder, itemEl.nextSibling);
                    }
                    placeholderActive = true;
                });
                
                return itemEl;
            }

            // (ê²Œì„ ëª¨ë“œ) í•™ìƒ ì¹ íŒ ë Œë”ë§
            function renderChalkboard() {
                chalkboard.innerHTML = '';
                const student = gameState.students[gameState.currentStudent];
                student.chalkboard.forEach(itemData => {
                    const chalkItem = createChalkItem(itemData.value, itemData.id, itemData.type, false); // isStudyMode = false
                    chalkboard.appendChild(chalkItem);
                });
                chalkboard.appendChild(clearChalkboardBtn); 
                updateParentheses();
            }


            // --- [ìˆ˜ì •ëœ ë¶€ë¶„] ---
            // ì¸ë²¤í† ë¦¬ ë“œë ì˜ì—­ ë¡œì§
            inventoryContainer.addEventListener('dragover', (e) => {
                e.preventDefault();
                
                // [ìˆ˜ì •] ì¹ íŒì—ì„œ ì˜¤ëŠ” ì•„ì´í…œì¼ ë•Œë§Œ í•˜ì´ë¼ì´íŠ¸ (ê²Œì„ ëª¨ë“œ/ê³µë¶€ ëª¨ë“œ ê³µí†µ)
                if (currentDraggingElement && currentDraggingElement.classList.contains('chalk-item')) {
                     inventoryContainer.style.backgroundColor = '#4a5568';
                     return; // ì¹ íŒ ì•„ì´í…œì€ ì¸ë²¤í† ë¦¬ ë‚´ë¶€ ìˆœì„œ ë³€ê²½(í”Œë ˆì´ìŠ¤í™€ë”) ë¡œì§ì„ íƒ€ì§€ ì•ŠìŒ
                }

                // --- ì•„ë˜ëŠ” ê²Œì„ ëª¨ë“œ ì „ìš© (ì¸ë²¤í† ë¦¬ ê°„ ìˆœì„œ ë³€ê²½) ---
                if (isStudyMode) return; // ê³µë¶€ ëª¨ë“œëŠ” ì¸ë²¤í† ë¦¬ ê°„ ìˆœì„œ ë³€ê²½ X

                // (ê²Œì„ ëª¨ë“œ) ì¸ë²¤í† ë¦¬ ë‚´ë¶€ ë“œë˜ê·¸ì¼ ë•Œ í•˜ì´ë¼ì´íŠ¸
                if (currentDraggingElement && currentDragSourceContainer === inventoryContainer) {
                    inventoryContainer.style.backgroundColor = '#4a5568';
                }
                // (ê²Œì„ ëª¨ë“œ) ì¸ë²¤í† ë¦¬ ë‚´ë¶€ ë“œë˜ê·¸ ì‹œ í”Œë ˆì´ìŠ¤í™€ë” ì²˜ë¦¬
                if (currentDraggingElement && currentDragSourceContainer === inventoryContainer && e.target === inventoryContainer) {
                    inventoryContainer.appendChild(dragPlaceholder);
                    placeholderActive = true;
                }
            });

            inventoryContainer.addEventListener('dragleave', (e) => {
                // [ìˆ˜ì •] ëª¨ë“œì™€ ê´€ê³„ ì—†ì´ ë°°ê²½ìƒ‰ ì´ˆê¸°í™”
                inventoryContainer.style.backgroundColor = '#1f2937';
                if (!inventoryContainer.contains(e.relatedTarget)) {
                    removePlaceholder();
                }
            });
            
            inventoryContainer.addEventListener('drop', (e) => {
                e.preventDefault();
                inventoryContainer.style.backgroundColor = '#1f2937';
                
                const dataStr = e.dataTransfer.getData('text/plain');
                if (!dataStr) {
                    removePlaceholder();
                    return;
                }
                
                const data = JSON.parse(dataStr);

                if (isStudyMode) {
                    // (ê³µë¶€ ëª¨ë“œ) ì¹ íŒì—ì„œ ì˜¨ ì•„ì´í…œë§Œ ë°›ì•„ì„œ 'ì œê±°' ì²˜ë¦¬
                    if (data.source === 'chalkboard' && currentDraggingElement) {
                        gameState.studyMode.chalkboard = gameState.studyMode.chalkboard.filter(item => item.id !== data.id);
                        renderStudyChalkboard(); // ì¹ íŒ ìƒˆë¡œê³ ì¹¨
                    }
                    // (ê³µë¶€ ëª¨ë“œ) ì¸ë²¤í† ë¦¬ ê°„ ìˆœì„œ ë³€ê²½ì€ ë§‰ìŒ

                } else {
                    // (ê²Œì„ ëª¨ë“œ)
                    const student = gameState.students[gameState.currentStudent];

                    if (data.source === 'chalkboard' && currentDraggingElement) {
                        // (ê²Œì„ ëª¨ë“œ) ì¹ íŒì—ì„œ ì¸ë²¤í† ë¦¬ë¡œ ë˜ëŒë¦¬ê¸°
                        const itemInStudentData = student.inventoryItems.find(item => item.id === data.id);
                        if (itemInStudentData) {
                            itemInStudentData.isInChalkboard = false;
                        }
                        student.chalkboard = student.chalkboard.filter(item => item.id !== data.id);
                        renderInventory(); 
                        renderChalkboard(); 

                    } else if (data.source === 'inventory' && currentDragSourceContainer === inventoryContainer && currentDraggingElement) {
                        // (ê²Œì„ ëª¨ë“œ) ì¸ë²¤í† ë¦¬ ë‚´ë¶€ ìˆœì„œ ë³€ê²½
                        const draggedItemIndex = student.inventoryItems.findIndex(item => item.id === data.id);
                        if (draggedItemIndex !== -1) {
                            const [draggedItem] = student.inventoryItems.splice(draggedItemIndex, 1);
                            
                            let targetIndex = Array.from(inventoryContainer.children).indexOf(dragPlaceholder);
                            if (targetIndex === -1 || targetIndex === inventoryContainer.children.length - 1) { 
                                student.inventoryItems.push(draggedItem);
                            } else {
                                student.inventoryItems.splice(targetIndex, 0, draggedItem);
                            }
                        }
                        renderInventory(); 
                    }
                }

                // ê³µí†µ ë¡œì§
                removePlaceholder();
                currentDraggingElement = null;
                currentDragSourceContainer = null;
            });
            // --- [ìˆ˜ì •ëœ ë¶€ë¶„ ë] ---


            // ì¹ íŒ ë“œë ì˜ì—­
            function removePlaceholder() {
                if (placeholderActive && dragPlaceholder.parentNode) {
                    dragPlaceholder.parentNode.removeChild(dragPlaceholder);
                }
                placeholderActive = false;
            }
            
            chalkboard.addEventListener('dragover', (e) => {
                e.preventDefault();
                chalkboard.style.backgroundColor = '#2d3748';
                
                if (e.target === chalkboard) {
                    chalkboard.insertBefore(dragPlaceholder, clearChalkboardBtn); 
                    placeholderActive = true;
                }
            });
            chalkboard.addEventListener('dragleave', (e) => {
                chalkboard.style.backgroundColor = '#1a202c';
                if (!chalkboard.contains(e.relatedTarget)) {
                    removePlaceholder();
                }
            });
            chalkboard.addEventListener('drop', (e) => {
                e.preventDefault();
                e.stopPropagation(); 
                chalkboard.style.backgroundColor = '#1a202c';
                
                const dataStr = e.dataTransfer.getData('text/plain');
                if (!dataStr) {
                    removePlaceholder(); 
                    return;
                }

                const data = JSON.parse(dataStr);
                let itemData;
                let currentChalkboard;
                let placeholderIndex = Array.from(chalkboard.children).indexOf(dragPlaceholder);

                // [ìˆ˜ì •] ëª¨ë“œì— ë”°ë¼ ì¹ íŒ ìƒíƒœ ë¶„ë¦¬
                if (isStudyMode) {
                    currentChalkboard = gameState.studyMode.chalkboard;
                } else {
                    currentChalkboard = gameState.students[gameState.currentStudent].chalkboard;
                }

                if (data.source === 'study-inventory') {
                    // (ê³µë¶€ ëª¨ë“œ) ì¸ë²¤í† ë¦¬ì—ì„œ ì¹ íŒìœ¼ë¡œ (ì•„ì´í…œ ë³µì‚¬)
                    itemData = gameState.studyMode.inventoryItems.find(item => item.id === data.id);
                    if (itemData) {
                        // ì¹ íŒì— ë†“ì„ ë• ê³ ìœ  ID ìƒˆë¡œ ë°œê¸‰
                        const itemCopy = { ...itemData, id: `chalk_${Date.now()}_${Math.random().toString(36).substr(2, 5)}` }; 
                        
                        if (placeholderIndex !== -1) {
                            currentChalkboard.splice(placeholderIndex, 0, itemCopy);
                        } else {
                            currentChalkboard.push(itemCopy);
                        }
                    }
                    renderStudyChalkboard(); // ê³µë¶€ ëª¨ë“œ ì¹ íŒ ë Œë”ë§

                } else if (data.source === 'inventory') {
                    // (ê²Œì„ ëª¨ë“œ) ì¸ë²¤í† ë¦¬ì—ì„œ ì¹ íŒìœ¼ë¡œ
                    const student = gameState.students[gameState.currentStudent];
                    itemData = student.inventoryItems.find(item => item.id === data.id);
                    if (itemData) {
                        itemData.isInChalkboard = true;
                        
                        if (placeholderIndex !== -1) {
                            currentChalkboard.splice(placeholderIndex, 0, itemData);
                        } else {
                            currentChalkboard.push(itemData);
                        }
                    }
                    renderInventory(); // ê²Œì„ ëª¨ë“œ ì¸ë²¤í† ë¦¬ ë Œë”ë§
                    renderChalkboard(); // ê²Œì„ ëª¨ë“œ ì¹ íŒ ë Œë”ë§

                } else if (data.source === 'chalkboard' && currentDraggingElement) {
                    // (ê³µí†µ) ì¹ íŒ ë‚´ë¶€ì—ì„œ ìˆœì„œ ë³€ê²½
                    itemData = currentChalkboard.find(item => item.id === data.id);
                    if (itemData) {
                        const oldIndex = currentChalkboard.findIndex(item => item.id === itemData.id);
                        currentChalkboard.splice(oldIndex, 1); 

                        let newIndex = placeholderIndex;
                        if (newIndex !== -1 && oldIndex < newIndex) {
                            newIndex--; 
                        }

                        if (newIndex === -1 || newIndex >= currentChalkboard.length) {
                            currentChalkboard.push(itemData);
                        } else {
                            currentChalkboard.splice(newIndex, 0, itemData);
                        }
                    }
                    // ëª¨ë“œì— ë§ì¶° ì¹ íŒ ë Œë”ë§
                    if (isStudyMode) renderStudyChalkboard();
                    else renderChalkboard();
                } else {
                    removePlaceholder();
                    return; 
                }
                
                removePlaceholder();
                currentDraggingElement = null; 
                currentDragSourceContainer = null;
            });
            
            // [ìˆ˜ì •] isStudyMode íŒŒë¼ë¯¸í„° ì¶”ê°€
            function createChalkItem(value, inventoryId, itemType, isStudyMode = false) {
                const itemEl = document.createElement('span');
                itemEl.className = 'chalk-item draggable';
                itemEl.textContent = value;
                itemEl.draggable = true;
                itemEl.dataset.inventoryId = inventoryId;
                itemEl.dataset.type = itemType;
                itemEl.dataset.item = value; 

                itemEl.addEventListener('dragstart', (e) => {
                    e.stopPropagation();
                    e.dataTransfer.setData('text/plain', JSON.stringify({ 
                        value: value, 
                        id: inventoryId, 
                        type: itemType,
                        source: 'chalkboard' // ì¹ íŒì—ì„œ ë‚˜ê°€ëŠ” ê±´ ê³µí†µ
                    }));
                    currentDraggingElement = itemEl;
                    currentDragSourceContainer = chalkboard; 
                    setTimeout(() => itemEl.classList.add('opacity-20'), 0);
                });

                itemEl.addEventListener('dragend', (e) => {
                    e.stopPropagation();
                    itemEl.classList.remove('opacity-20');
                    removePlaceholder(); 
                    currentDraggingElement = null;
                    currentDragSourceContainer = null;
                });

                itemEl.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    if (itemEl === currentDraggingElement) return;
                    if (!currentDraggingElement) return;

                    const rect = itemEl.getBoundingClientRect();
                    const midX = rect.left + rect.width / 2;
                    if (e.clientX < midX) {
                        chalkboard.insertBefore(dragPlaceholder, itemEl);
                    } else {
                        chalkboard.insertBefore(dragPlaceholder, itemEl.nextSibling);
                    }
                    placeholderActive = true;
                });

                // [ìˆ˜ì •] ì¹ íŒ ì•„ì´í…œ í´ë¦­: ëª¨ë“œì— ë”°ë¼ ë‹¤ë¥´ê²Œ ë™ì‘
                itemEl.addEventListener('click', () => {
                    if (isStudyMode) {
                        // (ê³µë¶€ ëª¨ë“œ) ì¹ íŒì—ì„œ ì•„ì´í…œ ì œê±°
                        gameState.studyMode.chalkboard = gameState.studyMode.chalkboard.filter(item => item.id !== inventoryId);
                        renderStudyChalkboard();
                    } else {
                        // (ê²Œì„ ëª¨ë“œ) ì¹ íŒì—ì„œ ì¸ë²¤í† ë¦¬ë¡œ ë˜ëŒë¦¬ê¸°
                        const student = gameState.students[gameState.currentStudent];
                        student.chalkboard = student.chalkboard.filter(item => item.id !== inventoryId);
                        const itemInInventory = student.inventoryItems.find(item => item.id === inventoryId);
                        if (itemInInventory) {
                            itemInInventory.isInChalkboard = false;
                        }
                        renderInventory();
                        renderChalkboard(); 
                    }
                });
                
                return itemEl;
            }

            // ì¹ íŒ ì§€ìš°ê¸°
            clearChalkboardBtn.addEventListener('click', clearChalkboard);

            // [ìˆ˜ì •] ëª¨ë“œì— ë”°ë¼ ì¹ íŒ ë¹„ìš°ê¸°
            function clearChalkboard() {
                if (isStudyMode) {
                    gameState.studyMode.chalkboard = [];
                    renderStudyChalkboard();
                } else {
                    const student = gameState.students[gameState.currentStudent];
                    student.inventoryItems.forEach(item => {
                        if (student.chalkboard.some(chalkItem => chalkItem.id === item.id)) {
                            item.isInChalkboard = false;
                        }
                    });
                    student.chalkboard = []; 
                    renderInventory(); 
                    renderChalkboard(); 
                }
                resultDisplay.innerHTML = '<h3 class="font-responsive-title text-yellow-400">= ?</h3>';
            }


            // --- ê´„í˜¸ ìë™ ë³€ê²½ ë¡œì§ ---
            function updateParentheses() {
                const items = Array.from(chalkboard.querySelectorAll('.chalk-item'));
                
                let currentDepth = 0;
                let maxDepth = 0;
                items.forEach(item => {
                    const originalOp = item.dataset.item;
                    if (originalOp === '(') {
                        currentDepth++;
                        if (currentDepth > maxDepth) {
                            maxDepth = currentDepth;
                        }
                    } else if (originalOp === ')') {
                        if (currentDepth > 0) {
                            currentDepth--;
                        }
                    }
                });

                if (maxDepth === 0) return;

                let nestingLevel = 0;
                const parens = ['()', '{}', '[]']; 
                const parensLength = parens.length;
                const effectiveMaxDepth = Math.max(1, maxDepth);

                items.forEach(item => {
                    const originalOp = item.dataset.item; 

                    if (originalOp === '(') {
                        let symbolIndex = (effectiveMaxDepth - 1) - nestingLevel;
                        let finalIndex = ((symbolIndex % parensLength) + parensLength) % parensLength;
                        
                        const [open] = parens[finalIndex];
                        if (item.textContent !== open) item.textContent = open;
                        nestingLevel++;
                    } else if (originalOp === ')') {
                        if (nestingLevel > 0) {
                            nestingLevel--;
                            
                            let symbolIndex = (effectiveMaxDepth - 1) - nestingLevel;
                            let finalIndex = ((symbolIndex % parensLength) + parensLength) % parensLength;

                            const [, close] = parens[finalIndex];
                            if (item.textContent !== close) item.textContent = close;
                        } else {
                            if (item.textContent !== ')') item.textContent = ')';
                        }
                    }
                });
            }

            // --- ê³„ì‚° ë¡œì§ ---
            calculateBtn.addEventListener('click', () => {
                const items = Array.from(chalkboard.querySelectorAll('.chalk-item'));
                let expression = ""; 
                let originalExpression = ""; 
                let resultText = ""; 
                let resultStatus = "success"; 
                
                if (items.length === 0) {
                    originalExpression = "ì‹ì´ ì—†ìŠµë‹ˆë‹¤!";
                    resultText = "ì˜¤ë¥˜";
                    resultStatus = "error";
                    resultDisplay.innerHTML = '<h3 class="font-responsive-title text-red-400">ì‹ì´ ì—†ìŠµë‹ˆë‹¤!</h3>';
                    
                } else {
                    // [ìˆ˜ì •] ê³µë¶€ ëª¨ë“œì—ì„œëŠ” í•­ìƒ ìˆ«ì ë¶™ì´ê¸° ê°•ì œ
                    if (isStudyMode || gameState.settings.chalkboard.concatenateNumbers) {
                        let currentNumStr = "";
                        for (const item of items) {
                            const text = item.textContent.trim();
                            if (item.dataset.type === 'number') {
                                currentNumStr += text;
                            } else {
                                if (currentNumStr.length > 0) {
                                    expression += currentNumStr;
                                    currentNumStr = "";
                                }
                                expression += text;
                            }
                        }
                        if (currentNumStr.length > 0) expression += currentNumStr;
                    } else {
                        expression = items.map(item => item.textContent).join(' ');
                    }

                    originalExpression = items.map(item => item.textContent).join('');
                    expression = expression.replace(/Ã—/g, '*').replace(/Ã·/g, '/');
                    expression = expression.replace(/[\[{]/g, '(').replace(/[\]}]/g, ')');
                    
                    const sanitizedExpression = expression.replace(/\s/g, '');
                    if (!/^[\d()+\-*/.]*$/.test(sanitizedExpression)) {
                        expression = "ì˜ëª»ëœ ë¬¸ì í¬í•¨!"; 
                        resultText = "ì˜¤ë¥˜";
                        resultStatus = "error";
                        resultDisplay.innerHTML = `<h3 class="font-responsive-title text-red-400">${expression}</h3>`;
                        
                    } else if (sanitizedExpression.includes('()') || sanitizedExpression.includes('++') || sanitizedExpression.includes('--') || sanitizedExpression.includes('**') || sanitizedExpression.includes('//')) {
                        expression = "ì˜ëª»ëœ ì‹ì…ë‹ˆë‹¤!";
                        resultText = "ì˜¤ë¥˜";
                        resultStatus = "error";
                        resultDisplay.innerHTML = `<h3 class="font-responsive-title text-red-400">${expression}</h3>`;

                    } else {
                        try {
                            // [ìˆ˜ì •] ê³µë¶€ ëª¨ë“œì—ì„œëŠ” ìˆ«ì ì—°ì† ê²€ì‚¬ ìŠ¤í‚µ
                            if (!isStudyMode && !gameState.settings.chalkboard.concatenateNumbers && /\d\s+\d/.test(expression)) {
                                throw new Error("ì—°ì‚°ì ì—†ì´ ìˆ«ìê°€ ì—°ì†ë˜ì—ˆìŠµë‹ˆë‹¤.");
                            }
                            
                            let evalExpression = expression.replace(/(\d)\(/g, '$1*('); 
                            evalExpression = evalExpression.replace(/\)(\d)/g, ')*$1'); 
                            evalExpression = evalExpression.replace(/\)\(/g, ')*('); 
                            
                            const result = new Function('return ' + evalExpression)();
                            
                            if (typeof result === 'number' && !isNaN(result)) {
                                resultText = result.toString();
                                resultDisplay.innerHTML = `<h3 class="font-responsive-title text-green-400">= ${result}</h3>`;
                            } else {
                                originalExpression = "ê³„ì‚° ì˜¤ë¥˜!";
                                resultText = "ì˜¤ë¥˜";
                                resultStatus = "error";
                                resultDisplay.innerHTML = `<h3 class="font-responsive-title text-red-400">${expression}</h3>`;
                            }
                        } catch (error) {
                            console.error('Calculation error:', error);
                            
                            if (error.message === "ì—°ì‚°ì ì—†ì´ ìˆ«ìê°€ ì—°ì†ë˜ì—ˆìŠµë‹ˆë‹¤.") {
                                originalExpression = "ì—°ì‚°ì ì—†ì´ ìˆ«ìê°€ ì—°ì†ë˜ì—ˆìŠµë‹ˆë‹¤.";
                            } else {
                                originalExpression = "ê³„ì‚° ë¶ˆê°€! (ì‹ ì˜¤ë¥˜)";
                            }
                            resultText = "ì˜¤ë¥˜";
                            resultStatus = "error";
                            resultDisplay.innerHTML = `<h3 class="font-responsive-title text-red-400">${originalExpression}</h3>`; 
                        }
                    }
                }
                
                showResultStepsModal(originalExpression, resultText, resultStatus);
            });
            
            function showResultStepsModal(originalExpr, result, status) {
                stepsExpression.textContent = originalExpr;
                stepsResult.textContent = result;
                stepsList.innerHTML = ''; 

                if (status === 'error') {
                    stepsResult.classList.remove('text-green-400');
                    stepsResult.classList.add('text-red-400');
                    stepsExpression.classList.add('text-red-400');
                } else {
                    stepsResult.classList.remove('text-red-400');
                    stepsResult.classList.add('text-green-400');
                    stepsExpression.classList.remove('text-red-400');
                    
                    let steps = [];
                    const hasParen = originalExpr.match(/[(){}\[\]]/);
                    const hasMulDiv = originalExpr.match(/[\Ã—\Ã·]/);
                    const hasAddSub = originalExpr.match(/[+\-]/); 

                    if (hasParen) steps.push('<li>ê´„í˜¸ ì•ˆì˜ ì‹ì„ ë¨¼ì € ê³„ì‚°í•©ë‹ˆë‹¤.</li>');
                    if (hasMulDiv) steps.push(`<li>ê³±ì…ˆ(Ã—)ê³¼ ë‚˜ëˆ—ì…ˆ(Ã·)ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</li>`);
                    if (hasAddSub) steps.push(`<li>ë§ì…ˆ(+)ê³¼ ëº„ì…ˆ(-)ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</li>`);
                    
                    if (steps.length === 0 && result !== "ì˜¤ë¥˜") {
                        steps.push('<li>ì‹ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</li>');
                    }

                    stepsList.innerHTML = steps.map((step, index) => {
                        return step.replace('<li>', `<li><span class="font-bold mr-1">${index + 1}.</span>`);
                    }).join('');
                }
                
                resultStepsModal.classList.remove('hidden');
                resultStepsModal.classList.add('flex');
            }
            
            closeStepsBtn.addEventListener('click', () => {
                resultStepsModal.classList.add('hidden');
                resultStepsModal.classList.remove('flex');
            });


            // --- ì„¤ì • ëª¨ë‹¬ ë¡œì§ (ê²Œì„ ëª¨ë“œ ì „ìš©) ---
            function openSettingsModal() {
                // ìˆ«ì
                const numSettings = gameState.settings.number;
                numMinInput.value = numSettings.min;
                numMaxInput.value = numSettings.max;
                numDuplicatesInput.checked = numSettings.allowDuplicates;
                numCustomInput.value = numSettings.customList.join(', ');
                numModeRange.checked = numSettings.mode === 'range';
                numModeCustom.checked = numSettings.mode === 'custom';
                numScopeStudent.checked = numSettings.customScope === 'student'; 
                numScopeGlobal.checked = numSettings.customScope === 'global'; 

                // ê¸°í˜¸
                const opSettings = gameState.settings.operator;
                opCustomInput.value = opSettings.customList.join(', ');
                opRandomInput.checked = opSettings.random;
                renderOperatorChecklist(); 
                opModeChecklist.checked = opSettings.mode === 'checklist';
                opModeCustom.checked = opSettings.mode === 'custom';
                opScopeStudent.checked = opSettings.customScope === 'student'; 
                opScopeGlobal.checked = opSettings.customScope === 'global'; 
                
                // ì¹ íŒ
                chalkConcatNumsInput.checked = gameState.settings.chalkboard.concatenateNumbers;

                updateRadioOptionsVisibility();
                settingsModal.classList.remove('hidden');
                settingsModal.classList.add('flex');
            }

            document.querySelectorAll('input[name="num-mode"], input[name="op-mode"]').forEach(radio => {
                radio.addEventListener('change', updateRadioOptionsVisibility);
            });

            function updateRadioOptionsVisibility() {
                document.querySelectorAll('.settings-options').forEach(opt => opt.style.display = 'none');
                document.querySelectorAll('input[type="radio"]:checked + label + .settings-options').forEach(opt => opt.style.display = 'block');
            }

            function renderOperatorChecklist() {
                opChecklist.innerHTML = '';
                gameState.availableOperators.forEach(op => {
                    const isParenSet = op === '( )';
                    const isChecked = isParenSet ? 
                        gameState.settings.operator.checklist.includes('(') : 
                        gameState.settings.operator.checklist.includes(op);
                        
                    const div = document.createElement('div');
                    div.className = 'flex items-center';
                    div.innerHTML = `
                        <input type="checkbox" id="op-${op}" value="${op}" class="op-check w-5 h-5 mr-2 bg-gray-700 border-gray-600" ${isChecked ? 'checked' : ''}>
                        <label for="op-${op}" class="font-responsive-small text-2xl">${op}</label>
                    `;
                    opChecklist.appendChild(div);
                });
            }

            function closeSettingsModal() {
                settingsModal.classList.add('hidden');
                settingsModal.classList.remove('flex');
            }

            function saveSettings() {
                // ìˆ«ì
                gameState.settings.number.mode = document.querySelector('input[name="num-mode"]:checked').value;
                gameState.settings.number.min = parseInt(numMinInput.value) || 1;
                gameState.settings.number.max = parseInt(numMaxInput.value) || 9;
                gameState.settings.number.allowDuplicates = numDuplicatesInput.checked;
                gameState.settings.number.customList = numCustomInput.value.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));
                gameState.settings.number.customScope = document.querySelector('input[name="num-scope"]:checked').value; 

                // ê¸°í˜¸
                gameState.settings.operator.mode = document.querySelector('input[name="op-mode"]:checked').value;
                gameState.settings.operator.random = opRandomInput.checked;
                
                const checkedOperators = [];
                opChecklist.querySelectorAll('.op-check:checked').forEach(cb => {
                    const value = cb.value;
                    if (value === '( )') {
                        checkedOperators.push('(');
                        checkedOperators.push(')');
                    } else {
                        checkedOperators.push(value);
                    }
                });
                gameState.settings.operator.checklist = checkedOperators;
                
                gameState.settings.operator.customList = opCustomInput.value.split(',')
                    .map(s => s.trim())
                    .filter(s => s.length > 0);
                gameState.settings.operator.customScope = document.querySelector('input[name="op-scope"]:checked').value; 
                
                // ì¹ íŒ
                gameState.settings.chalkboard.concatenateNumbers = chalkConcatNumsInput.checked;

                populateCustomPools(); 
                closeSettingsModal();
            }

            function populateCustomPools() {
                const numSettings = gameState.settings.number;
                const opSettings = gameState.settings.operator;

                // 1. (GLOBAL)
                gameState.drawBoxCustomNumbers = [...numSettings.customList];
                gameState.drawBoxCustomOperators = [];
                opSettings.customList.forEach(op => {
                    if (op === '( )') { 
                        gameState.drawBoxCustomOperators.push('(');
                        gameState.drawBoxCustomOperators.push(')');
                    } else {
                        gameState.drawBoxCustomOperators.push(op);
                    }
                });

                // 2. (STUDENT)
                for (const studentName in gameState.students) {
                    const student = gameState.students[studentName];
                    student.privateCustomNumPool = [...numSettings.customList];
                    student.privateCustomOpPool = [];
                    opSettings.customList.forEach(op => {
                        if (op === '( )') { 
                            student.privateCustomOpPool.push('(');
                            student.privateCustomOpPool.push(')');
                        } else {
                            student.privateCustomOpPool.push(op);
                        }
                    });
                }
            }

            // [ìˆ˜ì •] ë¹ ì§„ ë¦¬ìŠ¤ë„ˆ 3ì¤„ ë‹¤ì‹œ ì¶”ê°€
            openSettingsBtns.forEach(btn => btn.addEventListener('click', openSettingsModal));
            closeSettingsBtn.addEventListener('click', closeSettingsModal);
            saveSettingsBtn.addEventListener('click', saveSettings);

            // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---
            function showTempMessage(element, message, color = 'green') {
                const originalBorder = element.style.borderColor;
                const borderColor = color === 'red' ? '#f87171' : '#34d399';
                element.style.borderColor = borderColor;
                element.style.boxShadow = `0 0 10px ${borderColor}`;
                
                let msgEl = element.parentNode.querySelector('.temp-message');
                if (!msgEl) {
                    msgEl = document.createElement('div');
                    msgEl.className = 'font-responsive-small mt-2 temp-message';
                    element.parentNode.insertBefore(msgEl, element.nextSibling);
                }
                msgEl.textContent = message;
                msgEl.style.color = borderColor;

                setTimeout(() => {
                    element.style.borderColor = originalBorder;
                    element.style.boxShadow = 'none';
                    msgEl.remove();
                }, 2000);
            }

            // --- ì´ˆê¸°í™” ---
            openSettingsModal(); 
            closeSettingsModal(); 
            showScreen('opening-screen');

        });
    </script>

</body>
</html>